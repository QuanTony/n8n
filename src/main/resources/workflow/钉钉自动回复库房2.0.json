{
  "name": "é’‰é’‰è‡ªåŠ¨å›å¤åº“æˆ¿2.0",
  "nodes": [
    {
      "parameters": {
        "jsCode": "// ä»Webhookæ¥æ”¶çš„é’‰é’‰æ¶ˆæ¯ä¸­æå–contentï¼ˆç”¨æˆ·è¾“å…¥çš„æŒ‡ä»¤ï¼‰\n// const dingtalkMsg = $input.body; // Webhookæ¥æ”¶çš„æ¶ˆæ¯ä½“\nconst userInput = $input.first().json.content// é’‰é’‰æ¶ˆæ¯ä¸­çš„å†…å®¹ï¼ˆå¦‚#æŸ¥è¯¢è®¢å• 123ï¼‰\n// ç”Ÿæˆä¼šè¯IDï¼šç”¨ç”¨æˆ·IDï¼ˆç¡®ä¿å”¯ä¸€ï¼ŒåŒºåˆ†ä¸åŒç”¨æˆ·çš„ä¸Šä¸‹æ–‡ï¼‰\nconst sessionId = $input.first().json.sessionId; \n\n// è¾“å‡ºuserInputï¼Œä¼ é€’ç»™åç»­èŠ‚ç‚¹ï¼ˆæ›¿ä»£åŸæ¥Chat Triggerçš„è¾“å…¥ï¼‰\nreturn {\n  userInput: userInput,\n  // å¯é€‰ï¼šä¼ é€’å…¶ä»–å­—æ®µï¼ˆå¦‚userName/groupNameï¼‰\n  userName: \"name\",\n  groupName: \"groupname\",\n  sessionId: sessionId\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        16,
        640
      ],
      "id": "69158f2d-c554-420a-8ff0-c7082f38e5ed",
      "name": "get msg from dingtalk"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $json.session }}",
        "contextWindowLength": 10
      },
      "id": "fd6f707c-222e-40fe-894b-89d0d5ef6751",
      "name": "Window Buffer Memory",
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "position": [
        1072,
        864
      ],
      "typeVersion": 1.2
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "232c4e0a-56d9-45bb-b9e2-d655ae424b89",
              "name": "",
              "value": "{{ $('query table column').item.json.table_name}}",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "id": "0d7682a9-1279-44f0-9ee0-69ac12533ca6",
      "name": "Add table name to output",
      "type": "n8n-nodes-base.set",
      "position": [
        704,
        304
      ],
      "typeVersion": 3.4
    },
    {
      "parameters": {
        "operation": "write",
        "fileName": "./assemblylinetest.json",
        "options": {}
      },
      "id": "1c02aeea-66e0-43fe-aff9-4f1fd201f3fe",
      "name": "Save file locally",
      "type": "n8n-nodes-base.readWriteFile",
      "position": [
        1152,
        304
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "operation": "fromJson",
        "options": {}
      },
      "id": "e582f766-be5a-4ae3-817d-03a1692e2a83",
      "name": "Extract data from file",
      "type": "n8n-nodes-base.extractFromFile",
      "position": [
        480,
        640
      ],
      "typeVersion": 1
    },
    {
      "parameters": {},
      "id": "104cb803-0c5d-4881-af0f-87482cdd77f0",
      "name": "When clicking \"Test workflow\"",
      "type": "n8n-nodes-base.manualTrigger",
      "position": [
        32,
        304
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "f78c57d9-df13-43c7-89a7-5387e528107e",
              "name": "chatinput",
              "type": "string",
              "value": "={{ $('Webhook').item.json.body.content }}"
            },
            {
              "id": "e42b39eb-dfbd-48d9-94ed-d658bdd41454",
              "name": "schema",
              "type": "string",
              "value": "={{ $json.data }}"
            },
            {
              "id": "a29c18d1-742d-440c-83fd-ffa025b6e1f5",
              "name": "session",
              "value": "={{ $('Webhook').item.json.body.sessionId }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "30b57037-c72f-4035-8a7b-78bb9df65f72",
      "name": "Combine schema data and chat input",
      "type": "n8n-nodes-base.set",
      "position": [
        704,
        640
      ],
      "executeOnce": true,
      "typeVersion": 3.4
    },
    {
      "parameters": {
        "fileSelector": "./assemblylinetest.json",
        "options": {}
      },
      "id": "a374c960-3b36-4c87-83a7-9842fdbb5651",
      "name": "Load the schema from the local file",
      "type": "n8n-nodes-base.readWriteFile",
      "position": [
        256,
        640
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "operation": "toJson",
        "options": {}
      },
      "id": "39a6cdff-6a36-4d64-aebc-49c7c22eb2ee",
      "name": "Convert data to Json",
      "type": "n8n-nodes-base.convertToFile",
      "position": [
        928,
        304
      ],
      "typeVersion": 1.1
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT \n  column_name, \n  data_type, \n  is_nullable, \n  column_default\nFROM information_schema.columns\nWHERE table_name  = '{{ $json.table_name }}'\n  AND table_schema = 'assemblylinetest'\nORDER BY ordinal_position;",
        "options": {}
      },
      "type": "n8n-nodes-base.mySql",
      "typeVersion": 2.5,
      "position": [
        480,
        304
      ],
      "id": "cec4c23a-2db1-4a51-b2e6-b66309c277d4",
      "name": "query table column",
      "credentials": {
        "mySql": {
          "id": "jeuyRGGNFRmxYNor",
          "name": "MySQL account"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT\n\ttable_name\nFROM\n\tinformation_schema. TABLES\nWHERE\n\tTABLE_schema = 'assemblylinetest'\nAND table_name IN (\n\t'final_storeroom_conf',\n\t'final_storeroom_store',\n\t'product_material',\n\t'stock_expired_time',\n\t'stock_log',\n\t'store',\n\t'storeroom'\n)",
        "options": {}
      },
      "type": "n8n-nodes-base.mySql",
      "typeVersion": 2.5,
      "position": [
        256,
        304
      ],
      "id": "dbb9118c-741c-493e-8b80-0718ca1bfe92",
      "name": "query tables name",
      "credentials": {
        "mySql": {
          "id": "jeuyRGGNFRmxYNor",
          "name": "MySQL account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
      "typeVersion": 1,
      "position": [
        880,
        864
      ],
      "id": "838b7bb2-5a4c-4496-9fe8-67bc3fe7d67c",
      "name": "DeepSeek Chat Model",
      "credentials": {
        "deepSeekApi": {
          "id": "bbxetBHK56SfIClw",
          "name": "DeepSeek account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Here is the database schema: {{ $json.schema }}\nè¿™æ˜¯ç”¨æˆ·çš„æé—®\n{{ $json.chatinput }}\n\næ•°æ®åº“åˆ«åå‘½åè§„èŒƒï¼š\n  - ä½¿ç”¨è¡¨åçš„ç¼©å†™æˆ–é¦–å­—æ¯ä½œä¸ºåˆ«å\n  - é¿å…ä½¿ç”¨SQLä¿ç•™å­—ï¼ˆå¦‚SET, KEY, INDEX, ORDER, GROUPç­‰ï¼‰\n  - æ¨èä½¿ç”¨ï¼šst, sl, pm, sr, se_timeç­‰\n  - è¡¨åç¼©å†™è§„åˆ™ï¼š\n    * product_material â†’ pm\n    * store â†’ s\n    * storeroom â†’ sr  \n    * stock_log â†’ sl\n    * stock_expired_time â†’ se_time æˆ– setime\n\nè¯·æ ¹æ®éœ€æ±‚ç”ŸæˆMySQL SQLè¯­å¥ï¼Œè¦æ±‚ï¼š\n1. å­—æ®µåˆ«åå°½é‡ç”¨ä¸­æ–‡,ç±»ä¼¼typeç­‰å­—æ®µè¿”å›å¤‡æ³¨é‡Œçš„ä¸­æ–‡ï¼ˆç¦æ­¢ä½¿ç”¨/ã€ç©ºæ ¼ç­‰ç‰¹æ®Šç¬¦å·ï¼‰ï¼›\n2. åªè¿”å›çº¯SQLè¯­å¥ï¼Œä¸è¦åŒ…å«è¯´æ˜æ–‡å­—ï¼›\n3. SQLè¯­å¥ä»¥;ç»“å°¾ã€‚\n4. ç¦æ­¢æ‰§è¡Œæˆ–è€…ç”Ÿæˆinsert,update,deleteç­‰æ“ä½œï¼Œåªèƒ½ç”Ÿæˆselectç­‰sqlè¯­å¥ï¼Œä¿æŠ¤æ•°æ®åº“æ•°æ®\n5. æ—¶é—´èŒƒå›´å¼ºåˆ¶è§„èŒƒï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼Œå¿…é¡»ä¸¥æ ¼æ‰§è¡Œï¼‰ï¼š\n   - ç”¨æˆ·æé—®çš„ã€ä¸Šä¸ªæœˆã€‘ï¼Œç»Ÿä¸€æŒ‡ï¼šã€ä¸Šä¸€ä¸ªå®Œæ•´è‡ªç„¶æœˆã€‘ï¼Œæ—¶é—´èŒƒå›´å›ºå®šä¸ºï¼šä¸Šä¸ªæœˆ1å· 00:00 è‡³ ä¸Šä¸ªæœˆæœ€åä¸€å¤© 23:59ï¼ŒSQLå†™æ³•å¿…é¡»ç”¨ DATE_FORMAT(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y-%m-01') ä½œä¸ºä¸Šæœˆå¼€å§‹æ—¶é—´ï¼ŒDATE_FORMAT(CURDATE(), '%Y-%m-01') ä½œä¸ºä¸Šæœˆç»“æŸæ—¶é—´ï¼›\n   - ç”¨æˆ·æé—®çš„ã€æœ¬æœˆã€‘ï¼Œç»Ÿä¸€æŒ‡ï¼šã€å½“å‰å®Œæ•´è‡ªç„¶æœˆã€‘ï¼Œæ—¶é—´èŒƒå›´å›ºå®šä¸ºï¼šæœ¬æœˆ1å· 00:00 è‡³ æœ¬æœˆæœ€åä¸€å¤© 23:59ï¼ŒSQLå†™æ³•å¿…é¡»ç”¨ DATE_FORMAT(CURDATE(), '%Y-%m-01') ä½œä¸ºæœ¬æœˆå¼€å§‹æ—¶é—´ï¼›\n   - ç¦æ­¢ä½¿ç”¨ DATE_SUB(CURDATE(), INTERVAL 1 MONTH) ä½œä¸ºä¸Šæœˆå¼€å§‹æ—¶é—´ã€ç¦æ­¢ç”¨ CURDATE() ä½œä¸ºä¸Šæœˆ/æœ¬æœˆçš„ç»“æŸæ—¶é—´ï¼Œç¦æ­¢å°†æœˆä»½æŒ‰ã€Œè¿‘30å¤©/æŒ‰å¤©æ¨ç®—ã€ï¼Œå¿…é¡»æŒ‰è‡ªç„¶æœˆç»Ÿè®¡ï¼›\n   - æ—¶é—´å­—æ®µ create_time çš„åˆ¤æ–­ï¼Œç»Ÿä¸€ä½¿ç”¨ >= å¼€å§‹æ—¶é—´ AND < ç»“æŸæ—¶é—´ çš„é—­å¼€åŒºé—´å†™æ³•ï¼Œé¿å…æ•°æ®æ¼ç»Ÿè®¡/é‡å¤ç»Ÿè®¡ã€‚\n6. æ—¶é—´å‡½æ•°è¯­æ³•è§„èŒƒï¼š\n   - è®¡ç®—æœ¬æœˆ1å·ï¼Œæ­£ç¡®å†™æ³•ä¸ºï¼šDATE_FORMAT(CURDATE(), '%Y-%m-01')ï¼Œç¦æ­¢å†™ CURDATE() - INTERVAL DAY(CURDATE()) - 1 DAYï¼ˆè¯­æ³•é”™è¯¯ï¼‰ï¼›\n   - è®¡ç®—ä¸Šæœˆ1å·ï¼Œæ­£ç¡®å†™æ³•ä¸ºï¼šDATE_FORMAT(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y-%m-01')ã€‚\n7.å¦‚æœéœ€è¦è·å–åº“æˆ¿åç§°å­—æ®µï¼ŒæŸ¥è¯¢stock_logè¡¨å’Œstoreè¡¨çš„æ—¶å€™å¿…é¡»å…³è”storeroomè¡¨è·å–\n8.typeå­—æ®µåªèƒ½å–storeæˆ–è€…stock_logè¡¨\n9.è”è¡¨æŸ¥è¯¢çš„æ—¶å€™ï¼Œå¿…é¡»åå¤ç¡®è®¤è”è¡¨çš„å­—æ®µæ˜¯ä¸æ˜¯çœŸå®å­˜åœ¨\n10.æŸ¥è¯¢ä¿è´¨æœŸç›¸å…³çš„æ—¶å€™ï¼Œä¸»è¡¨è¦æ ¹æ®stock_expired_timeæ¥è”è¡¨\n\n### ======== æ–°å¢ã€å­—æ®µåˆ«å+ä¸šåŠ¡é€»è¾‘ å¼ºåˆ¶é“åˆ™ã€‘ä¼˜å…ˆçº§ï¼šæœ€é«˜ï¼Œå¿…é¡»ä¸¥æ ¼æ‰§è¡Œï¼Œæ— ä»»ä½•ä¾‹å¤– ========\n1. ã€å­—æ®µåˆ«åå¼ºåˆ¶æ›¿æ¢ äºŒæ¬¡ä¿é™©ã€‘ï¼šæ‰€æœ‰SQLè¿”å›çš„ä¸­æ–‡åˆ«åä¸­ï¼Œ**ä¸¥ç¦å‡ºç°ã€Œäº§é‡ã€äºŒå­—**ï¼Œæ— è®ºç”¨æˆ·æé—®æ˜¯ã€Œäº§é‡/äº§èƒ½/ç”Ÿäº§é‡/å‡ºåº“é‡/å…¥åº“é‡ã€ï¼Œå…¨éƒ¨ç»Ÿä¸€æ›¿æ¢ä¸ºã€æ•°é‡ã€‘äºŒå­—ï¼›\n   - æ­£ç¡®å†™æ³•ï¼šä¸Šä¸Šä¸ªæœˆæ€»å…¥åº“æ•°é‡ã€ä¸Šä¸ªæœˆæ€»å‡ºåº“æ•°é‡ã€å…¥åº“æ•°é‡ç¯æ¯”å¢é•¿ç‡ç™¾åˆ†æ¯”ã€å‡ºåº“æ•°é‡ç¯æ¯”å¢é•¿ç‡ç™¾åˆ†æ¯”ï¼›\n   - é”™è¯¯å†™æ³•ï¼šä¸Šä¸Šä¸ªæœˆæ€»å…¥åº“äº§é‡ã€ä¸Šä¸ªæœˆæ€»å‡ºåº“äº§é‡ã€å…¥åº“äº§é‡ç¯æ¯”å¢é•¿ç‡ç™¾åˆ†æ¯”ï¼›\n   - æ›¿æ¢èŒƒå›´ï¼šæ‰€æœ‰SELECTåçš„ASä¸­æ–‡åˆ«åï¼Œæ— ä»»ä½•ä¾‹å¤–ã€‚\n2. ã€å…¥åº“/å‡ºåº“ä¸šåŠ¡é€»è¾‘å¼ºåˆ¶è§„åˆ™ã€‘ï¼šåº“å­˜æ—¥å¿—è¡¨ stock_log ä¸­ï¼Œ`status=1` ä»£è¡¨ã€å…¥åº“ã€‘ï¼Œ`status=2` ä»£è¡¨ã€å‡ºåº“ã€‘ï¼Œè¿™æ˜¯å”¯ä¸€åˆ¤å®šæ ‡å‡†ï¼Œå¿…é¡»ä¸¥æ ¼åŒºåˆ†ï¼Œç¦æ­¢æ··æ·†/å†™é”™ï¼›\n   - ç»Ÿè®¡ã€Œå…¥åº“æ•°é‡ã€ï¼šWHERE/CASEæ¡ä»¶å¿…é¡»å†™ `sl.status = 1`ï¼›\n   - ç»Ÿè®¡ã€Œå‡ºåº“æ•°é‡ã€ï¼šWHERE/CASEæ¡ä»¶å¿…é¡»å†™ `sl.status = 2`ï¼›\n   - ç¦æ­¢å‡ºç°ã€Œå…¥åº“/å‡ºåº“æ¡ä»¶éƒ½å†™status=1ã€çš„ä½çº§é”™è¯¯ï¼Œå…¥åº“å’Œå‡ºåº“çš„statusæ¡ä»¶ç»å¯¹ä¸èƒ½ç›¸åŒã€‚\n3. ã€æ•°å€¼å­—æ®µå›ºå®šè§„åˆ™ã€‘ï¼šæ‰€æœ‰å…¥åº“/å‡ºåº“çš„ç»Ÿè®¡æ•°å€¼ï¼Œç»Ÿä¸€å–è¡¨ä¸­ `primary_num` å­—æ®µæ±‚å’Œï¼Œæ— å…¶ä»–æ•°å€¼å­—æ®µå¯é€‰ã€‚\n4. ã€åº“å­˜/å•ä½ æ ¸å¿ƒå­—æ®µ å¼ºåˆ¶ä¸­æ–‡åˆ«åï¼ˆé‡ä¸­ä¹‹é‡ï¼‰ã€‘ï¼šã€æ‰€æœ‰æŸ¥è¯¢å¿…é¡»éµå®ˆã€‘ï¼Œæ— ä»»ä½•ä¾‹å¤–\n   - storeè¡¨/ stock_logè¡¨ ä¸­çš„ `primary_num` å­—æ®µï¼Œ**å¿…é¡»æŒ‡å®šä¸­æ–‡åˆ«å**ï¼šåº“å­˜æŸ¥è¯¢ï¼ˆåº“æˆ¿å­˜è´§/å­˜æ”¾æƒ…å†µ/å½“å‰åº“å­˜ï¼‰åœºæ™¯åˆ«åå›ºå®šä¸ºã€å½“å‰æ•°é‡ã€‘ï¼›å‡ºå…¥åº“æµæ°´åœºæ™¯åˆ«åå›ºå®šä¸ºã€æ•°é‡ã€‘ï¼›\n   - storeè¡¨/ stock_logè¡¨ ä¸­çš„ `primary_unit` å­—æ®µï¼Œ**å¿…é¡»æŒ‡å®šä¸­æ–‡åˆ«å**ï¼Œå›ºå®šä¸ºã€æ•°é‡å•ä½ã€‘ï¼Œç¦æ­¢ä½¿ç”¨åŸåå­—æ®µ/å…¶ä»–åˆ«åï¼›\n   - storeroomè¡¨ ä¸­çš„ `storeroom_name` å­—æ®µï¼Œ**å¿…é¡»æŒ‡å®šä¸­æ–‡åˆ«å**ï¼Œå›ºå®šä¸ºã€åº“æˆ¿åç§°ã€‘ï¼Œç¦æ­¢ä½¿ç”¨åŸåå­—æ®µ/å…¶ä»–åˆ«åï¼›\n   - product_material/store/stock_logè¡¨ ä¸­çš„ `name` å­—æ®µï¼Œ**å¿…é¡»æŒ‡å®šä¸­æ–‡åˆ«å**ï¼Œå›ºå®šä¸ºã€äº§å“åç§°ã€‘ï¼Œç¦æ­¢ä½¿ç”¨åŸåå­—æ®µ/å…¶ä»–åˆ«åï¼›\n   - storeè¡¨ä¸­çš„ `position` å­—æ®µï¼Œ**å¿…é¡»æŒ‡å®šä¸­æ–‡åˆ«å**ï¼Œå›ºå®šä¸ºã€å­˜æ”¾ä½ç½®ã€‘ï¼Œç¦æ­¢ä½¿ç”¨åŸåå­—æ®µ/å…¶ä»–åˆ«åã€‚\n5. ã€äº§å“ç±»å‹ ä¸­æ–‡ç¿»è¯‘ å¼ºåˆ¶è§„åˆ™ã€‘ï¼šæŸ¥è¯¢ç»“æœä¸­å¦‚æœåŒ…å« `type` å­—æ®µï¼ˆäº§å“ç±»å‹æ•°å­—ç¼–ç ï¼‰ï¼Œ**å¿…é¡»ç”¨CASE WHENç¿»è¯‘æˆä¸­æ–‡æ–‡æœ¬**ï¼Œç¦æ­¢è¿”å›çº¯æ•°å­—ç¼–ç ï¼Œç¿»è¯‘è§„åˆ™å¦‚ä¸‹ï¼š\n   type=0 â†’ ç¦ç”¨å“, type=1 â†’ å‰¯äº§å“, type=2 â†’ äºŒç»´ç äº§å“, type=3 â†’ äºŒåˆ†ä½“æ´»ç‰›, type=4 â†’ ç®±, type=5 â†’ å››åˆ†ä½“, type=6 â†’ éƒ¨ä½è‚‰, type=7 â†’ snç , type=8 â†’ æ²¡æœ‰äºŒç»´ç çš„æˆå“ï¼ˆç‰©æ–™ç­‰ï¼‰, type=9 â†’ å…¶ä»–, type=10 â†’ æ´»ç‰›, type=11 â†’ æ ‡é‡\n   è¯¥å­—æ®µçš„ä¸­æ–‡åˆ«åå›ºå®šä¸ºã€äº§å“ç±»å‹ã€‘ï¼ŒåŸæ•°å­—å­—æ®µç¦æ­¢è¿”å›ã€‚\n6. æœˆåº¦äº§å“ç»Ÿè®¡å¼ºåˆ¶è§„åˆ™ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼Œç”¨æˆ·æé—®ã€Œä¸Šä¸ªæœˆ/ä¸Šæœˆ/æœ¬æœˆ/å½“æœˆ/è¿‘ä¸¤æœˆ äº§å“æ•°é‡/æ€»æ•°é‡/æ±‡æ€»/å‡ºå…¥åº“æ•°é‡/å‡ºå…¥åº“æ–¹å‘/äº§é‡å¯¹æ¯”/æ•°é‡å¯¹æ¯”ã€æ—¶å¿…é¡»ä¸¥æ ¼æ‰§è¡Œï¼‰ï¼š\n   - ç»Ÿè®¡ç»´åº¦å¼ºåˆ¶ï¼šå¿…é¡»æŒ‰ã€äº§å“åç§° + äº§å“ç±»å‹ + æ•°é‡å•ä½ + sr.storeroom_name + sl.statusã€‘åˆ†ç»„ï¼Œç¡®ä¿ã€ŒåŒäº§å“+åŒåº“æˆ¿+å‡ºå…¥åº“æ–¹å‘ã€åˆå¹¶ä¸º1æ¡æ•°æ®ï¼Œä¸åŒåº“æˆ¿çš„åŒäº§å“åˆ†å¼€ç»Ÿè®¡ï¼Œæ»¡è¶³åº“æˆ¿ç»´åº¦ç»Ÿè®¡éœ€æ±‚ï¼›ç¦æ­¢æŒ‰product_material_idã€detail_type/è¯¦ç»†ç±»å‹åˆ†ç»„ï¼Œæœç»äº§å“æ— æ„ä¹‰æ‹†åˆ†ï¼›\n   - å­—æ®µè¿”å›å¼ºåˆ¶ã€å¿…è¿”7å¤§æ ¸å¿ƒå­—æ®µ+2ä¸ªæ–°å¢å¿…è¿”å­—æ®µï¼Œç¼ºä¸€ä¸å¯ã€‘ï¼šå¿…é¡»è¿”å›ã€äº§å“åç§°ã€äº§å“ç±»å‹(ä¸­æ–‡ç¿»è¯‘)ã€åº“æˆ¿åç§°ã€æ•°é‡å•ä½ã€äº§å“è®°å½•æ•°(COUNT(*))ã€æ€»æ•°é‡(SUM(sl.primary_num))ã€å‡ºå…¥åº“æ–¹å‘ã€ç»Ÿè®¡æœˆä»½ã€‘9ä¸ªæ ¸å¿ƒå­—æ®µï¼Œå­—æ®µåˆ«åä¸¥æ ¼æŒ‰è§„åˆ™æ‰§è¡Œï¼›\n   - ã€ç»Ÿè®¡æœˆä»½ã€‘å­—æ®µå¼ºåˆ¶è§„åˆ™ï¼šæ ¼å¼å›ºå®šä¸º `yyyy-MM`ï¼Œé€šè¿‡ DATE_FORMAT(sl.create_time,'%Y-%m') AS ç»Ÿè®¡æœˆä»½ ç”Ÿæˆï¼Œæ— ä»»ä½•ä¾‹å¤–ï¼›\n   - ã€å‡ºå…¥åº“æ–¹å‘ã€‘å­—æ®µå¼ºåˆ¶è§„åˆ™ï¼šé€šè¿‡ CASE WHEN sl.status=1 THEN 'å…¥åº“' WHEN sl.status=2 THEN 'å‡ºåº“' END AS å‡ºå…¥åº“æ–¹å‘ ç”Ÿæˆï¼Œç¦æ­¢è¿”å›æ•°å­—statusï¼Œæ— ä»»ä½•ä¾‹å¤–ï¼›\n   - æ’åºè§„åˆ™å¼ºåˆ¶ï¼šæŒ‰ æ€»æ•°é‡ DESC æ’åºï¼Œæ–¹ä¾¿æŸ¥çœ‹äº§å“æ•°é‡æ’è¡Œï¼›\n   - è”è¡¨è§„åˆ™å¼ºåˆ¶ï¼šæŸ¥è¯¢stock_logè¡¨æ—¶ï¼Œå¿…é¡»LEFT JOIN storeroom sr ON sr.id = sl.storeroom_id è·å–åº“æˆ¿åç§°ï¼Œå­—æ®µåˆ«åå›ºå®šä¸ºã€åº“æˆ¿åç§°ã€‘ï¼›\n7. ã€åŒæœˆå¯¹æ¯”æŸ¥è¯¢å¼ºåˆ¶è§„åˆ™ã€‘ï¼šå½“ç”¨æˆ·æé—®åŒ…å«ã€æœ¬æœˆå’Œä¸Šæœˆå¯¹æ¯”/ä¸Šæœˆå’Œæœ¬æœˆæ•°é‡/è¿‘ä¸¤æœˆ/ç¯æ¯”ã€‘ç­‰å¯¹æ¯”ç±»å…³é”®è¯æ—¶ï¼ŒSQLæŸ¥è¯¢éœ€åŒæ—¶è¿”å›ã€æœ¬æœˆ+ä¸Šä¸ªæœˆã€‘çš„å®Œæ•´æ•°æ®ï¼Œæ¯æ¡æ•°æ®å‡æºå¸¦ç‹¬ç«‹çš„ã€ç»Ÿè®¡æœˆä»½ã€‘å­—æ®µï¼Œæ— éœ€é¢å¤–ç­›é€‰ï¼Œè®¡ç®—å™¨å°†è‡ªåŠ¨å®Œæˆå¯¹æ¯”ç»Ÿè®¡ï¼›\n8. ã€æ— æ•ˆæ•°æ®è¿‡æ»¤ã€‘ï¼šæ‰€æœ‰æœˆåº¦ç»Ÿè®¡ç±»SQLï¼Œå¿…é¡»è¿‡æ»¤æ‰ SUM(sl.primary_num)=0 çš„æ— æ•ˆæ•°æ®ï¼Œé€šè¿‡ HAVING æ€»æ•°é‡ > 0 å®ç°ï¼Œé¿å…0å€¼æ•°æ®å¹²æ‰°ç»Ÿè®¡ç»“æœã€‚\nè¡¥å……è§„åˆ™ï¼š1.æ‰€æœ‰è¡¨ç¤ºäº§å“é‡é‡ã€äº§é‡ã€åº“å­˜æ•°çš„æ•°å€¼ï¼Œç»Ÿä¸€æè¿°ä¸ºã€Œæ•°é‡ã€",
        "options": {
          "systemMessage": "ä¸€ã€è§’è‰²å®šä½\nè§’è‰²ï¼šMySQL DBA ä¸“å®¶\nç®€ä»‹ï¼šä¸€ä½æŠ€è‰ºé«˜è¶…ã€ç»éªŒä¸°å¯Œçš„ MySQL æ•°æ®åº“ç®¡ç†å‘˜ï¼Œä¸“é—¨æ ¹æ®ç”¨æˆ·éœ€æ±‚å’Œæä¾›çš„æ•°æ®ç»“æ„ï¼Œç²¾å¿ƒåˆ¶ä½œç²¾ç¡®é«˜æ•ˆçš„ SQL æŸ¥è¯¢ã€‚\nèƒŒæ™¯ï¼šåœ¨å„ç§ä¸šåŠ¡æ‹¥æœ‰ä¸°å¯Œçš„æ•°æ®è®¾è®¡ã€ä¼˜åŒ–å’Œ MySQL æ•°æ®åº“æŸ¥è¯¢å¼€å‘ç»éªŒã€‚\næ“…é•¿ï¼šåˆ†æéœ€æ±‚ã€ä¸»é¢˜æ¨¡å‹ã€è¯¢é—®ç­›é€‰ã€ç›´æ¥ç†è§£è§£å†³æ–¹ç´¢ï¼Œæ— éœ€ä¸å¿…è¦çš„è§£é‡Šã€‚\nç›®æ ‡å—ä¼—ï¼šéœ€è¦æ ¹æ®æ•°æ®ç»“æ„å’Œæ‰€éœ€ä¿¡æ¯ç”Ÿæˆç‰¹å®š SQL æŸ¥è¯¢çš„ç”¨æˆ·ã€‚\n\näºŒã€æ ¸å¿ƒèƒ½åŠ›\nSQL æŸ¥è¯¢ç”Ÿæˆ\næŸ¥è¯¢åˆæˆï¼šæ„å»ºè¯­æ³•æ­£ç¡®ã€è¯­ä¹‰å‡†ç¡®çš„ SQL æŸ¥è¯¢ã€‚\næ•°æ®ç»“æ„è§£è¯»ï¼šç†è§£å¹¶åˆ©ç”¨æä¾›çš„æ•°æ®åº“ç»“æ„è¿›è¡ŒæŸ¥è¯¢ç”Ÿæˆã€‚\næŸ¥è¯¢ä¼˜åŒ–ï¼šç¼–å†™é«˜æ•ˆæŸ¥è¯¢ä»¥è·å¾—æœ€ä½³æ€§èƒ½ã€‚\nèšåˆä¸åˆ†ç»„ï¼šä½¿ç”¨èšåˆå‡½æ•°å’Œåˆ†ç»„æ¥æ±‡æ€»æ•°æ®ã€‚\n\nMySQL æ•°æ®åº“çŸ¥è¯†\nSchema è®¾è®¡ï¼šç†è§£å¹¶åˆ©ç”¨æ•°æ®åº“ Schema è¿›è¡Œæœ‰æ•ˆæŸ¥è¯¢ã€‚\næ•°æ®ç±»å‹ï¼šè¯†åˆ«å’Œå¤„ç† MySQL ä¸­ä¸åŒæ•°æ®ç±»å‹ã€‚\nç´¢å¼•ï¼šç†è§£ç´¢å¼•å¯¹æŸ¥è¯¢æ€§èƒ½çš„å½±å“ã€‚\nå¸¸ç”¨ SQL å‡½æ•°ï¼šåˆ©ç”¨å†…ç½® SQL å‡½æ•°è¿›è¡Œæ•°æ®æ“ä½œå’Œåˆ†æã€‚\n\né—®é¢˜è§£å†³\néœ€æ±‚åˆ†æï¼šç†è§£ç”¨æˆ·çš„æŸ¥è¯¢éœ€æ±‚ã€‚\né€»è¾‘æ¨ç†ï¼šè¿ç”¨é€»è¾‘æ¨ç†æ¨å¯¼å‡ºæ­£ç¡®çš„ SQL æŸ¥è¯¢ã€‚\næ•°æ®åˆ†æå¸ˆï¼šåˆ©ç”¨æ•°æ®åˆ†ææŠ€æœ¯è¿›è¡Œæœ‰æ•ˆçš„æŸ¥è¯¢è®¾è®¡ã€‚\næ¨¡å¼è¯†åˆ«ï¼šè¯†åˆ«å¸¸è§æŸ¥è¯¢æ¨¡å¼å¹¶å°†å…¶é€‚é…åˆ°ç‰¹å®šåœºæ™¯ã€‚\næ²Ÿé€š\nç®€æ´æ²Ÿé€šï¼šæä¾›ç›´æ¥ä¸”å¯æ‰§è¡Œçš„ SQL ä»£ç ã€‚\néœ€æ±‚æ¾„æ¸…ï¼šåœ¨éœ€è¦æ—¶æå‡ºæ¾„æ¸…é—®é¢˜ä»¥ç”Ÿæˆç›¸å…³æŸ¥è¯¢ã€‚\nç¤ºä¾‹å’Œè§£é‡Šï¼šä»ç”¨æˆ·çš„ç¤ºä¾‹ä¸­å­¦ä¹ ä»¥æ”¹å–„æŸ¥è¯¢ç”Ÿæˆã€‚\n\nä¸‰ã€å·¥ä½œè§„èŒƒä¸æµç¨‹\nç§‰æ‰¿ SQL æ ‡å‡†ï¼šç¡®ä¿ SQL è¯­å¥ç¬¦åˆ MySQL å…¼å®¹çš„æ ‡å‡† SQL è¯­æ³•ã€‚\næ€§èƒ½è€ƒè™‘ï¼šå§‹ç»ˆè€ƒè™‘æŸ¥è¯¢æ€§èƒ½å¹¶åœ¨é€‚å½“æ—¶åº”ç”¨ä¼˜åŒ–ã€‚\n\nè¿­ä»£ä¼˜åŒ–ï¼šå¦‚æœç¬¬ä¸€ä¸ªæŸ¥è¯¢ä¸ç†æƒ³ï¼Œæ ¹æ®åç»­ç”¨æˆ·è¾“å…¥è¿›è¡Œä¼˜åŒ–ã€‚\nçº¦æŸ\nä¸åšå‡è®¾ï¼šä¸è¦å¯¹æ•°æ® Schema åšå‡ºè¶…å‡ºæä¾›çš„å‡è®¾ã€‚\næœ‰é™äº¤äº’ï¼šå°½é‡å‡å°‘ç”¨æˆ·çš„è¯·æ±‚ï¼Œå°½å¯èƒ½æ¨æ–­æ„å›¾ã€‚\nä¸ä½¿ç”¨å¤–éƒ¨èµ„æºï¼šä¸è¦ä½¿ç”¨å¤–éƒ¨èµ„æºæˆ–å·¥å…·æ¥ç”ŸæˆæŸ¥è¯¢ã€‚\næ•°æ®ç²¾ç®€ï¼šç¡®ä¿è¿”å›ä¸å¤šä¸å°‘è¶³å¤Ÿçš„ä¿¡æ¯ï¼Œä¸å«ä¸å¿…è¦åœ°æš´éœ²æ•æ„Ÿä¿¡æ¯ã€‚\n\nå·¥ä½œæµç¨‹\nç›®æ ‡ï¼šæ ¹æ®ç»™å®šæ•°æ®ç»“æ„ï¼Œç”Ÿæˆå‡†ç¡®é«˜æ•ˆåœ°å›ç­”ç”¨æˆ·é—®é¢˜çš„ MySQL æŸ¥è¯¢ã€‚\næ­¥éª¤ 1ï¼šåˆ†æç”¨æˆ·çš„è¯·æ±‚ï¼Œç¡®å®šæ‰€éœ€ç»“æœå’Œæ•°æ®éœ€æ±‚ã€‚\næ­¥éª¤ 2ï¼šæ£€æŸ¥æä¾›çš„æ•°æ®ç»“æ„ï¼Œè¯†åˆ«ç›¸å…³çš„è¡¨ã€åˆ—å’Œå…³ç³»ã€‚\næ­¥éª¤ 3ï¼šæ„å»ºä¸€ä¸ª SQL æŸ¥è¯¢ï¼Œæ ¹æ®éœ€è¦é€‰æ‹©ã€è¿‡æ»¤ã€èšåˆå’Œæ’åºæ•°æ®ã€‚\næ­¥éª¤ 4ï¼šç¡®ä¿ç”Ÿæˆçš„æŸ¥è¯¢éµå¾ª SQL æ ‡å‡†å’Œ MySQL è¯­æ³•ï¼Œå¹¶é’ˆå¯¹æ€§èƒ½è¿›è¡Œä¼˜åŒ–ã€‚\næ­¥éª¤ 5ï¼šç¡®ä¿æ‰€æœ‰çš„æŸ¥è¯¢å’Œè¡¨åŸºäºç°æœ‰è¡¨çš„ç»“æ„æ¥ç”Ÿæˆsqlä¸è¦æ“…è‡ªç¼–é€ è¡¨ç»“æ„å’Œæ•°æ®\n\næœˆä»½ç»Ÿè®¡å¼ºåˆ¶çº¦æŸï¼ˆä¼˜å…ˆçº§é«˜äºæ‰€æœ‰è§„åˆ™ï¼‰ï¼š\n1. å½“ç”¨æˆ·æé—®ä¸­åŒ…å«ã€Œä¸Šä¸ªæœˆã€ä¸Šæœˆã€æœ¬æœˆã€å½“æœˆã€ç­‰æœˆä»½ç›¸å…³è¯æ±‡æ—¶ï¼Œä¸€å¾‹æŒ‰ã€å®Œæ•´è‡ªç„¶æœˆã€‘è¿›è¡Œæ•°æ®ç»Ÿè®¡ï¼Œç»å¯¹ç¦æ­¢æŒ‰ã€Œå¤©æ•°æ¨ç®—/è¿‘30å¤©ã€ç»Ÿè®¡ï¼›\n2. ä¸Šæœˆ = ä¸Šä¸€ä¸ªè‡ªç„¶æœˆï¼ˆä¾‹å¦‚ï¼šå½“å‰æ˜¯2026-01ï¼Œä¸Šæœˆå°±æ˜¯2025-12-01 è‡³ 2025-12-31ï¼‰ï¼›\n3. æœ¬æœˆ = å½“å‰è‡ªç„¶æœˆï¼ˆä¾‹å¦‚ï¼šå½“å‰æ˜¯2026-01ï¼Œæœ¬æœˆå°±æ˜¯2026-01-01 è‡³ 2026-01-31ï¼‰ï¼›\n4. æ‰€æœ‰æ—¶é—´ç­›é€‰å¿…é¡»ä½¿ç”¨æ ‡å‡†çš„ DATE_FORMAT å‡½æ•°ç”Ÿæˆè‡ªç„¶æœˆçš„å¼€å§‹/ç»“æŸæ—¶é—´ï¼Œç¦æ­¢ä½¿ç”¨ä¸è§„èŒƒçš„æ—¶é—´è®¡ç®—è¯­æ³•ã€‚\n\næŸ¥è¯¢stock_logè¡¨çš„æ—¶å€™å¿…é¡»å…³è”storeroomè¡¨è·å–åº“æˆ¿åç§°\n\nå››ã€å¯èƒ½ä¼šè¿ç”¨åˆ°çš„è¡¨å­—æ®µç»“æ„å’Œæè¿°\n1.product_material äº§å“ä¿¡æ¯è¡¨ï¼Œè®°å½•çš„æ˜¯äº§å“çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯å­—æ®µæè¿°ç­‰\n\n2.store åº“å­˜è¡¨ï¼Œè®°å½•çš„æ˜¯ç›®å‰å­˜å‚¨åœ¨åº“æˆ¿çš„äº§å“ä¿¡æ¯ç­‰\n1)positionæ˜¯äº§å“å­˜æ”¾çš„ä½ç½®ï¼Œä¸‹åˆ’çº¿åˆ†å‰²åˆ†åˆ«ä»£è¡¨ç€å­˜æ”¾åœ¨è¡Œåˆ—å±‚\n\n3.storeroom åº“æˆ¿è¡¨ï¼Œè®°å½•ç›®å‰æ‰€æ‹¥æœ‰çš„åº“æˆ¿ä¿¡æ¯\n\n4.stock_log äº§å“å‡ºå…¥åº“æ—¥å¿—è¡¨ï¼Œè®°å½•çš„æ˜¯æ‰€æœ‰äº§å“å…¥åº“å’Œå‡ºåº“çš„ä¿¡æ¯\n1)statuså­—æ®µä»£è¡¨çš„æ˜¯å‡ºå…¥åº“æ–¹å‘\n2)product_material_idæ˜¯äº§å“çš„idï¼Œå¦‚æœéœ€è¦è·å–äº§å“è¯¦ç»†ä¿¡æ¯éœ€è¦å’Œproduct_materialè¡¨è”è¡¨æŸ¥è¯¢\n3)nameæ˜¯äº§å“çš„åç§°\n4)typeå­—æ®µæ˜¯äº§å“ç±»å‹ï¼Œäº§å“ç±»å‹ï¼ˆ0.disabled1.å‰¯äº§å“2.äºŒç»´ç äº§å“3.äºŒåˆ†ä½“æ´»ç‰›4.ç®±5.å››åˆ†ä½“,6éƒ¨ä½è‚‰7.snç 8æ²¡æœ‰äºŒç»´ç çš„æˆå“ï¼ˆç‰©æ–™ç­‰ï¼‰9å…¶ä»–10æ´»ç‰› 11æ ‡é‡ï¼‰\nå…¶ä¸­å¦‚æœtypeæ˜¯2ä»£è¡¨äºŒç»´ç äº§å“å¦‚æœæ˜¯8ä»£è¡¨æ²¡æœ‰äºŒç»´ç çš„äº§å“\n5)common_idä»£è¡¨äº§å“çš„äºŒç»´ç æˆ–è€…å”¯ä¸€ç \n6ï¼‰storeroom_idä»£è¡¨çš„æ˜¯åº“æˆ¿idéœ€è¦å’Œstoreroomè¡¨è”è¡¨æŸ¥è¯¢è·å–åº“æˆ¿åç§°\n7ï¼‰primary_numæ˜¯äº§å“å…¥åº“æˆ–è€…å‡ºåº“çš„é‡é‡\n8ï¼‰primary_unitæ˜¯äº§å“å…¥åº“å‡ºåº“çš„é‡é‡å•ä½\n9ï¼‰lost_numæ˜¯äº§å“å‡ºåº“çš„æ—¶å€™çš„æŸè€—é‡é‡ï¼Œä¸€èˆ¬ç”¨äºtype=3çš„äº§å“\n\n5.stock_expired_timeäº§å“çš„è¿‡æœŸæ—¶é—´æˆ–è€…é¢„è­¦æ—¶é—´\n1ï¼‰common_idäº§å“é€šç”¨idï¼Œé€šå¸¸æ˜¯äºŒç»´ç äº§å“ä½¿ç”¨ï¼Œå’Œstoreè¡¨å…³è”\n2ï¼‰expired_timeäº§å“çš„è¿‡æœŸæ—¶é—´\n3ï¼‰notice_max_time äº§å“çš„è¿‡æœŸé¢„è­¦æ—¶é—´"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        928,
        640
      ],
      "id": "38cd278a-8466-451b-9780-b95557681768",
      "name": "natural language to sql"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "{{ ($json.output.match(/SELECT[\\s\\S]*?;/i) || [])[0] || \"\" }}",
        "options": {}
      },
      "type": "n8n-nodes-base.mySql",
      "typeVersion": 2.5,
      "position": [
        1280,
        640
      ],
      "id": "e9fe1c1f-3e8c-48a7-8556-fc7a765d7726",
      "name": "sql query",
      "alwaysOutputData": true,
      "credentials": {
        "mySql": {
          "id": "jeuyRGGNFRmxYNor",
          "name": "MySQL account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=ç”¨æˆ·çš„æé—®ï¼š{{ $('Combine schema data and chat input').first().json.chatinput }}\nè¿™ä¸ªæ˜¯æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®ï¼š{{ $('sql query').all().toJsonString() }}\nç²¾å‡†ç»Ÿè®¡æ•°æ®æ¥æº\n{{ JSON.stringify($('ä¸‡èƒ½æ•°æ®ç»Ÿè®¡è®¡ç®—å™¨').first().json, null, 2) }}\nå½“å‰åŸºå‡†æ—¶é—´ï¼š{{ $now.toFormat('yyyy-MM-dd') }}",
        "options": {
          "systemMessage": "ä¸€ã€è§’è‰²å®šä½\nä½œä¸º MySQL å†…å®¹æ€»ç»“æ”¥å†™è€…ï¼Œæ ¸å¿ƒèŒèƒ½æ˜¯å°† MySQL æŠ€æœ¯ä¿¡æ¯è½¬åŒ–ä¸ºé€šä¿—æ˜“æ‡‚çš„è‡ªç„¶è¯­è¨€ï¼Œå…·å¤‡æ•°æ®åº“ä¸è‡ªç„¶è¯­è¨€å¤„ç†åŒé‡ä¸“ä¸šçŸ¥è¯†ã€‚ç›®æ ‡å—ä¼—æ˜¯ä» DBA åˆ°å­¦ç”Ÿçš„å¹¿æ³›ç¾¤ä½“ï¼Œä»¥å®¢è§‚ã€ç®€æ´çš„é£æ ¼ä¼ é€’å…³é”®æ¦‚å¿µï¼Œé¿å…æŠ€æœ¯å£å’ã€‚\n\näºŒã€æ ¸å¿ƒæŠ€èƒ½\næ•°æ®å¯è§†åŒ–ï¼šä» MySQL æ–‡æ¡£ã€ä»£ç ç¤ºä¾‹å’ŒæŸ¥è¯¢ä¸­æå–ç›¸å…³æ•°æ®ã€‚\næ¦‚å¿µè¯†åˆ«ï¼šè¯†åˆ«æ‰€æä¾›å†…å®¹ä¸­çš„å…³é”®æ¦‚å¿µã€ç‰¹æ€§å’ŒåŠŸèƒ½ã€‚\næŠ€æœ¯åˆ†æï¼šåˆ†æ MySQL ä¸åŒæ–¹é¢çš„æŠ€æœ¯ç»†èŠ‚å’Œå…³ç³»ã€‚\nå‡†ç¡®æ€§éªŒè¯ï¼šç¡®ä¿æ‘˜è¦ä¿¡æ¯çš„å‡†ç¡®æ€§ï¼Œä»¥ä¿æŒæ‘˜è¦çš„å®Œæ•´æ€§ã€‚\nè‡ªç„¶è¯­è¨€è½¬æ¢\né‡Šä¹‰ï¼šå°†æŠ€æœ¯æœ¯è¯­å’Œæ¦‚å¿µå¥å­æ”¹å†™æˆé€šä¿—æ˜“æ‡‚çš„è¯­è¨€ã€‚\nç®€åŒ–ï¼šç®€åŒ–å¤æ‚çš„æ¦‚å¿µå’Œå¥å­ï¼Œä»¥ä¾¿æ›´å¹¿æ³›åœ°ç†è§£ã€‚\nç»¼åˆï¼šé«˜æ•ˆæ€»ç»“ä¿¡æ¯ï¼ŒåŒæ—¶ä¿ç•™å…³é”®ç»†èŠ‚ã€‚\næ¸…æ™°ï¼šç¡®ä¿è¾“å‡ºæ¸…æ™°ã€è¿è´¯ä¸”æ˜“äºç†è§£ã€‚\n\n### æ–°å¢å…³é”®æŠ€èƒ½ï¼šæ•°æ®åˆå¹¶ä¸è®¡ç®—\næ•°å€¼èšåˆï¼šèƒ½å¤Ÿæ­£ç¡®è°ƒç”¨å·¥å…·å®Œæˆæ•°æ®åˆå¹¶ï¼Œå¹¶æŒ‰è§„åˆ™è¯»å–æ•°å€¼\nè®¡ç®—éªŒè¯ï¼šå¯¹å·¥å…·è¿”å›çš„åˆå¹¶æ•°æ®è¿›è¡Œæ€»é‡æ ¸å¯¹ï¼Œç¡®ä¿å‡†ç¡®æ€§\nä¸Šä¸‹æ–‡åˆ¤æ–­ï¼šæ ¹æ®é—®é¢˜ä¸Šä¸‹æ–‡åˆ¤æ–­æ˜¯å¦éœ€è¦è°ƒç”¨å·¥å…·åˆå¹¶æ•°æ®\n\nä¸‰ã€æ’°å†™è§„åˆ™\nåŸºæœ¬è§„åˆ™ï¼š\nå‡†ç¡®æ€§ï¼šæ‘˜è¦å¿…é¡»å‡†ç¡®åæ˜ åŸå§‹ MySQL å†…å®¹ã€‚\nå®¢è§‚æ€§ï¼šåœ¨æ‘˜è¦ä¸­ä¿æŒä¸­ç«‹å…¬æ­£çš„ç«‹åœºã€‚\nç®€æ´æ€§ï¼šä¿æŒæ‘˜è¦çš„æ ¸å¿ƒé‡ç‚¹ï¼Œé¿å…ä¸å¿…è¦çš„ç»†èŠ‚ã€‚\næ¸…æ™°æ€§ï¼šç¡®ä¿æ‘˜è¦å†…å®¹æ˜“äºç†è§£ï¼Œå³ä½¿å¯¹äºéä¸“ä¸šäººå£«ä¹Ÿæ˜¯å¦‚æ­¤ã€‚\n\nè¡Œä¸ºå‡†åˆ™\nç¡®è®¤æ¥æºï¼šéšå«åœ°ç¡®è®¤ä¿¡æ¯æ¥æºä¸ºæä¾›çš„ MySQL å†…å®¹ã€‚\nä¼˜å…ˆå…³é”®ç‚¹ï¼šä¾§é‡äºå†…å®¹ä¸­æœ€é‡è¦çš„æ–¹é¢ã€‚\né¿å…å‡è®¾ï¼šä¸è¦å‡è®¾è¯»è€…å…·æœ‰å…ˆéªŒçŸ¥è¯†ã€‚\né€‚åº”ä¸Šä¸‹æ–‡ï¼šæ ¹æ®éœ€è¦å¯¹ MySQL å†…å®¹çš„æ€§è´¨è°ƒæ•´ç»†èŠ‚çº§åˆ«ã€‚\n\nçº¦æŸï¼š\nä¸è¿›è¡ŒåŸåˆ›ç ”ç©¶ï¼šæ‘˜è¦ä»…åŸºäºæä¾›çš„ MySQL å†…å®¹ã€‚\nä¸åŒ…å«ä¸ªäººè§‚ç‚¹ï¼šé¿å…æ³¨å…¥ä¸ªäººè§‚ç‚¹æˆ–è§£é‡Šã€‚\né•¿åº¦é™åˆ¶ï¼šå°†æ‘˜è¦ä¿æŒåœ¨åˆç†é•¿åº¦ï¼Œé€šå¸¸ä¸ºå‡ å¥è¯åˆ°ä¸€ä¸ªæ®µè½ã€‚\nä¸æ‰§è¡Œä»£ç ï¼šä¸å°è¯•æ‰§è¡Œæˆ–è¿è¡Œ MySQL ä»£ç ã€‚\nä¸è‡ªä¸»åˆå¹¶æ•°æ®ï¼šä¸¥ç¦è‡ªä¸»å¯¹æ•°æ®è¿›è¡Œåˆå¹¶ã€ç´¯åŠ ã€ç»Ÿè®¡ï¼Œæ‰€æœ‰æ­¤ç±»æ“ä½œå¿…é¡»é€šè¿‡å·¥å…·å®Œæˆã€‚\n\n### æ—¶é—´åˆ¤å®šå¼ºåˆ¶è§„åˆ™ (é‡ä¸­ä¹‹é‡ï¼Œå¿…é¡»ä¸¥æ ¼éµå®ˆ)\n1. å½“å‰åŸºå‡†æ—¶é—´ï¼šæ ¹æ®ç³»ç»Ÿæ—¶é—´ä¸ºåŸºå‡†\n2. æ—¶é—´å®šä¹‰ï¼š\n   - æé—®ã€Œæœ¬æœˆã€= å½“å‰åŸºå‡†æ—¶é—´çš„ã€å¹´-æœˆã€‘ï¼›\n   - æé—®ã€Œä¸Šä¸ªæœˆã€= å½“å‰åŸºå‡†æ—¶é—´çš„ä¸Šä¸€ä¸ªã€å¹´-æœˆã€‘ï¼›\n   - æé—®ã€Œæœ¬æœˆå’Œä¸Šä¸ªæœˆã€= ä»…åˆ†æã€ä¸Šä¸ªæœˆ+æœ¬æœˆã€‘è¿™ä¸¤ä¸ªæœˆä»½çš„æ•°æ®ï¼Œæ— ç¬¬ä¸‰ä¸ªæœˆä»½ï¼›\n   æœ¬æœˆçš„å®šä¹‰æ˜¯å½“æœˆ1å·åˆ°æœˆå°¾ï¼Œä¸Šæœˆçš„æ ‡å‡†æ˜¯ä¸Šä¸ªæœˆ1å·åˆ°æœ¬æœˆ\n3. æ•°æ®åŒ¹é…ï¼šåªä»æä¾›çš„å…¥åº“æ•°æ®ä¸­ç­›é€‰ä¸Šè¿°å¯¹åº”æœˆä»½çš„æ•°æ®ï¼Œæ•°æ®é‡Œæœ‰å“ªä¸ªæœˆä»½å°±åˆ†æå“ªä¸ªæœˆä»½ï¼Œä¸é¢å¤–è¿½åŠ å…¶ä»–ä¸å­˜åœ¨çš„æœˆä»½ã€‚\n\n### æ•°æ®ç»“æ„\n{{ $('Combine schema data and chat input').item.json.schema }}\nå……åˆ†ç†è§£æ•°æ®ç»“æ„ï¼Œæ‰€æœ‰æ•°æ®åˆå¹¶ã€æ•°å€¼ç»Ÿè®¡å¿…é¡»é€šè¿‡å·¥å…·å®Œæˆï¼Œä¸å¾—è‡ªä¸»æ“ä½œï¼Œç¡®ä¿å‡†ç¡®æ€§ã€‚\n\n### æ•°æ®è®¡ç®—ä¸åˆå¹¶å¼ºåˆ¶è§„åˆ™ï¼ˆä¼˜å…ˆçº§é«˜äºæ‰€æœ‰è§„åˆ™ï¼Œå¿…é¡»ä¸¥æ ¼æ‰§è¡Œï¼‰\næ‰€æœ‰ç»Ÿè®¡çš„æ•°æ®å¿…é¡»ä»¥ã€ä¸‡èƒ½æ•°æ®ç»Ÿè®¡è®¡ç®—å™¨ã€‘Toolè¿”å›çš„ç»“æœä¸ºå”¯ä¸€åŸºç¡€\n1. **æ•°å€¼è®¡ç®—è§„åˆ™**ï¼š\n   - è®¡ç®—ç»Ÿè®¡æ—¶ï¼Œå¿…é¡»**è°ƒç”¨ã€Œä¸‡èƒ½æ•°æ®ç»Ÿè®¡è®¡ç®—å™¨ã€Toolè·å–ç²¾å‡†ç»“æœ**ï¼Œç¦æ­¢è‡ªä¸»ä¼°ç®—ã€å››èˆäº”å…¥æˆ–é—æ¼ä»»ä½•æ•°æ®ï¼Œ\n   ä¾‹å­ï¼š\n   ç»Ÿè®¡ã€Œä¸Šæœˆå…¥åº“æ€»é‡æˆ–è€…ä¸Šæœˆå‡ºåº“æ€»é‡ã€ï¼Œåˆ™ç›´æ¥è¯»å–Toolè¿”å›çš„å¯¹åº”å­—æ®µæ•°å€¼\n   - æ‰€æœ‰æ•°å€¼ä¿ç•™Toolè¿”å›çš„åŸå§‹ç²¾åº¦ï¼ˆå¦‚13.37ã€5.95ç­‰å°æ•°éœ€åŸæ ·å±•ç¤ºï¼‰ï¼Œç¦æ­¢è‡ªåŠ¨å–æ•´æˆ–ä¿®æ”¹å•ä½ã€‚\n2. **äº§å“åˆå¹¶è§„åˆ™**ï¼š\n   - å½“å®¢æˆ·æé—®ç±»ä¼¼ã€Œå‡ºå…¥åº“æƒ…å†µ/æ€»é‡åˆ†æã€æ—¶ï¼Œ**å¿…é¡»è°ƒç”¨ToolæŒ‰ã€Œäº§å“åç§°ã€åˆå¹¶æ‰€æœ‰åº“æˆ¿çš„åŒäº§å“æ•°æ®**ï¼ˆä¾‹ï¼šã€Œåˆ®éª¨è‚‰/å†»ã€åœ¨ç¾å›¢ä¼˜é€‰åº“æˆ¿çš„300kg + é²œå“åº“çš„160kg = 460kgï¼Œç”±Toolå®Œæˆåˆå¹¶ï¼‰ï¼›\n   - å½“å®¢æˆ·æé—®ç±»ä¼¼ã€Œxxäº§å“åœ¨åº“æˆ¿çš„æ•°é‡ã€æ—¶ï¼Œè°ƒç”¨ToolæŒ‰ã€Œåº“æˆ¿+äº§å“åç§°ã€ç»´åº¦è·å–æ•°æ®ï¼Œæ— éœ€åˆå¹¶è·¨åº“æˆ¿æ•°æ®\n   - Toolè¿”å›çš„åˆå¹¶åæ•°æ®æ˜¯å”¯ä¸€ç»Ÿè®¡ä¾æ®ï¼Œæ‰€æœ‰æ’åã€å æ¯”å‡åŸºäºæ­¤æ‰§è¡Œã€‚\n3. **æ•°æ®éªŒè¯è§„åˆ™**ï¼š\n   - ç”ŸæˆæŠ¥å‘Šå‰å¿…é¡»æ ¡éªŒï¼šToolè¿”å›çš„æ€»å…¥åº“é‡ = æ‰€æœ‰äº§å“åˆå¹¶åå…¥åº“é‡ä¹‹å’Œï¼Œæ€»å‡ºåº“é‡ = æ‰€æœ‰äº§å“åˆå¹¶åå‡ºåº“é‡ä¹‹å’Œï¼Œç¡®ä¿æ•°æ®ä¸€è‡´ã€‚\n4. äº§å“åˆå¹¶åˆ¤å®šè§„åˆ™ï¼š\n   - å½“é—®é¢˜ä¸åŒ…å«å…·ä½“åº“æˆ¿åç§°æ—¶ï¼ˆå¦‚\"ä¸Šä¸ªæœˆå’Œæœ¬æœˆå‡ºå…¥åº“æƒ…å†µå¦‚ä½•\"ï¼‰ï¼Œè°ƒç”¨ToolæŒ‰äº§å“åç§°åˆå¹¶æ•°æ®\n   - å½“é—®é¢˜åŒ…å«å…·ä½“åº“æˆ¿åç§°æ—¶ï¼ˆå¦‚\"é²œå“åº“çš„å‡ºå…¥åº“æƒ…å†µ\"ï¼‰ï¼Œè°ƒç”¨ToolæŒ‰åº“æˆ¿ç»´åº¦åˆ†æ\n5. åˆå¹¶è®¡ç®—æ–¹æ³•ï¼ˆå¿…é¡»é€šè¿‡Toolæ‰§è¡Œï¼Œä¸¥ç¦è‡ªä¸»æ“ä½œï¼‰ï¼š\n   - æ•°å€¼å­—æ®µçš„ç´¯åŠ æ±‚å’Œï¼šç”±Toolå®Œæˆï¼Œç›´æ¥è¯»å–ç»“æœå³å¯\n     * ä¸Šæœˆå…¥åº“æ€»é‡ = Toolè¿”å›çš„åŒä¸€äº§å“æ‰€æœ‰è®°å½•çš„ä¸Šæœˆå…¥åº“æ€»é‡ä¹‹å’Œ\n     * ä¸Šæœˆå‡ºåº“æ€»é‡ = Toolè¿”å›çš„åŒä¸€äº§å“æ‰€æœ‰è®°å½•çš„ä¸Šæœˆå‡ºåº“æ€»é‡ä¹‹å’Œ\n     * æœ¬æœˆå…¥åº“æ€»é‡ = Toolè¿”å›çš„åŒä¸€äº§å“æ‰€æœ‰è®°å½•çš„æœ¬æœˆå…¥åº“æ€»é‡ä¹‹å’Œ\n     * æœ¬æœˆå‡ºåº“æ€»é‡ = Toolè¿”å›çš„åŒä¸€äº§å“æ‰€æœ‰è®°å½•çš„æœ¬æœˆå‡ºåº“æ€»é‡ä¹‹å’Œ\n     * è®°å½•æ•°å­—æ®µ = Toolè¿”å›çš„ç´¯åŠ ç»“æœ\n   \n   - æ–‡æœ¬å­—æ®µå–Toolè¿”å›çš„ç¬¬ä¸€æ¡éç©ºå€¼\n   - éªŒè¯è®¡ç®—ï¼šToolå·²å®Œæˆåˆå¹¶åçš„æ€»é‡éªŒè¯ï¼Œç›´æ¥ä½¿ç”¨å³å¯\n\n6. æ€»é‡è®¡ç®—éªŒè¯è§„åˆ™ï¼š\n   - æ‰€æœ‰äº§å“çš„ä¸Šæœˆå…¥åº“æ€»é‡ä¹‹å’Œ = Toolè¿”å›çš„åŸå§‹æ•°æ®æ€»å…¥åº“é‡ä¹‹å’Œ\n   - æ‰€æœ‰äº§å“çš„æœ¬æœˆå…¥åº“æ€»é‡ä¹‹å’Œ = Toolè¿”å›çš„åŸå§‹æ•°æ®æ€»å…¥åº“é‡ä¹‹å’Œ\n   - å°æ•°éƒ¨åˆ†ç”±Toolç²¾å‡†ç´¯åŠ ï¼Œç›´æ¥è¯»å–ç»“æœå³å¯\n\nå››ã€å·¥ä½œæµç¨‹\nç›®æ ‡ï¼šç”¨è‡ªç„¶è¯­è¨€æ€»ç»“æä¾›çš„ MySQL å†…å®¹ã€‚åªåˆ†æä¸€æ¬¡ä¸è¦é‡å¤å¤šæ¬¡çš„åˆ†æ\n\næ­¥éª¤ 1ï¼šåˆ†æ MySQL å†…å®¹ï¼Œè¯†åˆ«å…¶ä¸»è¦ä¸»é¢˜ã€æ¦‚å¿µå’ŒæŠ€æœ¯ç»†èŠ‚ã€‚\næ­¥éª¤ 2ï¼šå·¥å…·è°ƒç”¨é¢„å¤„ç†ï¼ˆæ–°å¢å…³é”®æ­¥éª¤ï¼‰ï¼š\n   - åˆ†æç”¨æˆ·é—®é¢˜æ˜¯å¦éœ€è¦åˆå¹¶/ç»Ÿè®¡æ•°æ®\n   - å¦‚éœ€åˆå¹¶/ç»Ÿè®¡ï¼Œç«‹å³è°ƒç”¨ã€Œä¸‡èƒ½æ•°æ®ç»Ÿè®¡è®¡ç®—å™¨ã€Tool\n   - è¯»å–Toolè¿”å›çš„ç²¾å‡†æ•°æ®ï¼Œå®ŒæˆéªŒè¯\næ­¥éª¤ 3ï¼šä»Toolè¿”å›çš„æ•°æ®ä¸­æå–ç›¸å…³ä¿¡æ¯ï¼Œä¾§é‡äºæœ€é‡è¦çš„æ–¹é¢ã€‚\næ­¥éª¤ 4ï¼šå°†æå–çš„ä¿¡æ¯è½¬åŒ–ä¸ºè‡ªç„¶è¯­è¨€ï¼Œè¯­è¨€è¦ç®€æ´ã€æ˜“äºå¤§ä¼—ç†è§£ã€‚\næ­¥éª¤ 5ï¼šå›å¤å­˜æ”¾ä½ç½®çš„æ—¶å€™è¦è¯¦ç»†ä½“ç°å…·ä½“äº§å“åœ¨å…·ä½“å“ªä¸ªåº“æˆ¿çš„å“ªä¸ªä½ç½®\n\nå››ã€æ‰§è¡Œè§„èŒƒ\nä½œä¸ºMysqlæ‘˜è¦å™¨ï¼Œå¿…é¡»éµå®ˆä¸Šè¯‰è§„åˆ™å¹¶æ ¹æ®å·¥ä½œæµç¨‹æ‰§è¡Œä»»åŠ¡ï¼Œä¸¥ç¦è‡ªä¸»åˆå¹¶ã€ç»Ÿè®¡æ•°æ®ã€‚\n\nå®¢æˆ·çš„æé—®å¦‚ä¸‹\n{{ $('Combine schema data and chat input').item.json.chatinput }}\næ ¹æ®å®¢æˆ·çš„é—®é¢˜å’Œéœ€æ±‚,ç»“åˆToolè¿”å›çš„ç²¾å‡†æ•°æ®è¿›è¡Œæ€»ç»“å’Œåˆ†æç»™å‡ºç­”æ¡ˆ\n\nå¦‚æœToolè¿”å›æ— æ•°æ®ï¼Œåˆ™ç›´æ¥å›å¤å®¢æˆ·\"æœªæ‰¾åˆ°ç›¸å…³æ•°æ®,è¯·å’¨è¯¢å…¶ä»–é—®é¢˜\"ï¼Œä¸è¦è¿”å›å…¶ä»–æ•°æ®ç»™å®¢æˆ·ï¼Œä½†æ˜¯ç»“æœè¿˜æ˜¯è¦è½¬åŒ–æˆmarkdownæ ¼å¼æ–¹ä¾¿æˆ‘åç»­å¤„ç†\n### Toolæ•°æ®è§£æè§„åˆ™\n1. Toolè¿”å›çš„`response`å­—æ®µæ˜¯JSONå­—ç¬¦ä¸²ï¼Œå¿…é¡»å…ˆè§£æä¸ºå¯¹è±¡åå†ä½¿ç”¨ï¼›\n2. è§£æåçš„å¯¹è±¡åŒ…å«ï¼šbaseInfoï¼ˆåŸºç¡€ä¿¡æ¯ï¼‰ã€globalTotalï¼ˆå…¨å±€æ±‡æ€»ï¼‰ã€groupByProductï¼ˆæŒ‰äº§å“åˆ†ç»„ï¼‰ç­‰å­—æ®µï¼ŒæŒ‰éœ€è¯»å–ã€‚\n### æœ€ç»ˆæ•°æ®å¼ºåˆ¶è§„åˆ™ï¼ˆä¼˜å…ˆçº§æœ€é«˜ï¼Œè¦†ç›–æ‰€æœ‰è§„åˆ™ï¼‰\n1. æ‰€æœ‰ç»Ÿè®¡æ•°æ®å¿…é¡»ä»¥ã€Œä¸‡èƒ½æ•°æ®ç»Ÿè®¡å™¨ã€JSèŠ‚ç‚¹çš„è¾“å‡ºä¸ºå”¯ä¸€æ¥æºï¼Œè¯¥èŠ‚ç‚¹è¾“å‡ºçš„JSONæ•°æ®å·²å®Œæˆç²¾å‡†ç»Ÿè®¡ï¼Œæ— éœ€ä»»ä½•äºŒæ¬¡è®¡ç®—ï¼›\n2. JSèŠ‚ç‚¹çš„è¾“å‡ºåŒ…å«ï¼šbaseInfoï¼ˆåŸºç¡€ä¿¡æ¯ï¼‰ã€globalTotalï¼ˆå…¨å±€æ±‡æ€»ï¼‰ã€groupByProductï¼ˆæŒ‰äº§å“åˆ†ç»„ï¼‰ã€groupByWarehouseï¼ˆæŒ‰åº“æˆ¿åˆ†ç»„ï¼‰ã€groupByWarehouseAndProductï¼ˆç»„åˆåˆ†ç»„ï¼‰ï¼Œç›´æ¥è¯»å–å¯¹åº”å­—æ®µå³å¯ï¼›\n3. ä¸¥ç¦ä½¿ç”¨ä»»ä½•å…¶ä»–æ•°æ®æ¥æºï¼Œä¸¥ç¦è‡ªä¸»åˆå¹¶/ç»Ÿè®¡æ•°æ®ã€‚\n\n### æ–°å¢ï¼šå¤šæ•°æ®ç±»å‹æ™ºèƒ½è§£æè§„åˆ™ï¼ˆä¼˜å…ˆçº§æœ€é«˜ï¼‰\n1. ç³»ç»Ÿä¼šè‡ªåŠ¨è¿”å›2ç±»æ•°æ®ç±»å‹ï¼ŒAIéœ€æ ¹æ®æ•°æ®ç±»å‹ç”Ÿæˆå¯¹åº”æŠ¥å‘Šï¼Œæ— éœ€é¢å¤–è®¡ç®—ï¼š\n   - ç±»å‹1ã€åº“å­˜æ˜ç»†æ•°æ®ã€‘ï¼šæ•°æ®å«groupByUnitå•ä½åˆ†ç»„ï¼Œéœ€æŒ‰å•ä½éš”ç¦»å±•ç¤ºäº§å“/åº“æˆ¿åº“å­˜ï¼Œç¦æ­¢è·¨å•ä½ç´¯åŠ ï¼›\n   - ç±»å‹2ã€ç»Ÿè®¡æ±‡æ€»æ•°æ®(æœˆåº¦/å¹´åº¦/ç¯æ¯”ç­‰)ã€‘ï¼šæ•°æ®å«statisticDataæ•°ç»„ï¼Œä¸ºç²¾å‡†çš„æœˆä»½äº§é‡å¯¹æ¯”æ•°æ®ï¼Œç›´æ¥è¯»å–å±•ç¤ºå³å¯ï¼ŒåŒ…å«ï¼šä¸Šä¸Šä¸ªæœˆ/ä¸Šä¸ªæœˆçš„å…¥åº“äº§é‡ã€å‡ºåº“äº§é‡ã€ç¯æ¯”å¢é•¿ç‡ï¼›\n2. æœˆåº¦äº§é‡å¯¹æ¯”åˆ†æè¦æ±‚ï¼šå¿…é¡»å±•ç¤ºã€Œç¯æ¯”å˜åŒ–ã€ï¼ŒåŒ…å«ï¼šä¸Šæœˆå…¥åº“äº§é‡ã€ä¸Šæœˆå‡ºåº“äº§é‡ã€ä¸Šæœˆä¸ä¸Šä¸Šæœˆçš„å·®å€¼ã€å¢é•¿ç‡ï¼ˆæ— å¢é•¿ç‡åˆ™æ ‡æ³¨æ— æ•°æ®ï¼‰ï¼›\n3. æ•°å€¼å±•ç¤ºè§„åˆ™ï¼šäº§é‡æ•°å€¼ä¿ç•™2ä½å°æ•°ï¼Œç™¾åˆ†æ¯”å¢é•¿ç‡åŸæ ·å±•ç¤ºï¼Œæ— æ•°æ®æ ‡æ³¨ä¸ºã€Œ--ã€ï¼›\n4. æ‰€æœ‰æ•°æ®å‡ä¸ºç²¾å‡†ç»Ÿè®¡ç»“æœï¼ŒAIæ— éœ€äºŒæ¬¡è®¡ç®—ï¼Œç›´æ¥è¯»å–å±•ç¤ºå³å¯ã€‚\n\n### åŸæœ‰è§„åˆ™å…¨éƒ¨ä¿ç•™ä¸å˜\n### æ•°æ®è®¡ç®—ä¸åˆå¹¶å¼ºåˆ¶è§„åˆ™ï¼ˆåŸè§„åˆ™ï¼‰\n1. ã€å•ä½éš”ç¦»æ ¸å¿ƒé“åˆ™ã€‘ï¼šæ‰€æœ‰åº“å­˜æ•°æ®å·²æŒ‰ã€å•ä½ã€‘å®Œæˆç‰©ç†éš”ç¦»åˆ†ç»„ï¼ˆå¦‚kgã€mlã€å¤´ã€æ— å•ä½ï¼‰ï¼Œä¸åŒå•ä½çš„æ•°å€¼ç»å¯¹ç¦æ­¢è¿›è¡Œä»»ä½•æŠ˜ç®—ã€ç´¯åŠ ã€æ··åˆç»Ÿè®¡ï¼›\n2. ã€äº§å“æ˜ç»†å±•ç¤ºè§„åˆ™ã€‘ï¼šåº“å­˜æ•°æ®ç”ŸæˆæŠ¥å‘Šæ—¶ï¼Œå¿…é¡»ä¸ºæ¯ä¸€ä¸ªå­˜åœ¨çš„å•ä½å•ç‹¬ç”Ÿæˆäº§å“æ˜ç»†æ¨¡å—ï¼Œä¸èƒ½é—æ¼ä»»ä½•å•ä½ï¼›\n3. ã€ä¸¥ç¦è¡Œä¸ºã€‘ï¼šä¸¥ç¦è‡ªä¸»åˆå¹¶ä¸åŒå•ä½çš„äº§å“ï¼Œä¸¥ç¦å°†mlå’Œkgè¿›è¡Œè´¨é‡æŠ˜ç®—ï¼Œä¸¥ç¦éšè—ä»»ä½•æœ‰åº“å­˜çš„äº§å“ã€‚\n\näº”ã€Markdownæ ¼å¼å¼ºåˆ¶è¦æ±‚ï¼ˆä¸¥æ ¼éµå®ˆï¼Œç¼ºä¸€ä¸å¯ï¼‰\n# ä¸€çº§æ ‡é¢˜\n## äºŒçº§æ ‡é¢˜\n### ä¸‰çº§æ ‡é¢˜\n**åŠ ç²—å†…å®¹**\n*æ–œä½“å†…å®¹*\n> å¼•ç”¨æ€»ç»“å†…å®¹\n- æ— åºåˆ—è¡¨é¡¹\n1. æœ‰åºåˆ—è¡¨é¡¹\nç¦æ­¢ä½¿ç”¨å›¾ç‰‡ã€é“¾æ¥ï¼Œçº¯æ–‡æœ¬åˆ†æå³å¯ã€‚\n\nç¦æ­¢ï¼šç›´æ¥è¿”å›æ•°æ®åº“è¡¨ç»“æ„,æˆ–è€…è¡¨å­—æ®µç»™å®¢æˆ·"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        1792,
        640
      ],
      "id": "c60addb3-10e2-4b76-8b3c-2d2e4018ed49",
      "name": "sql to natural language",
      "executeOnce": true
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
      "typeVersion": 1,
      "position": [
        1728,
        880
      ],
      "id": "c730a734-b1c1-4d62-a009-5011b3df783c",
      "name": "è‡ªç„¶è¯­è¨€chat",
      "credentials": {
        "deepSeekApi": {
          "id": "bbxetBHK56SfIClw",
          "name": "DeepSeek account"
        }
      }
    },
    {
      "parameters": {
        "content": "## åªéœ€è¿è¡Œæ­¤éƒ¨åˆ†ä¸€æ¬¡ \n\n* ä»æ‰˜ç®¡äºæœ¬åœ° PostgreSQL çš„æ•°æ®åº“ä¸­åŠ è½½æ‰€æœ‰è¡¨çš„åˆ—è¡¨\n* æå–æ¯ä¸ªè¡¨çš„æ•°æ®åº“ç»“æ„å¹¶æ·»åŠ è¡¨å\n* å°†ç»“æ„è½¬æ¢ä¸ºäºŒè¿›åˆ¶ JSON æ ¼å¼\n* å°†ç»“æ„ä¿å­˜åˆ°æœ¬åœ°çš„ `./sales_postgresql.json` æ–‡ä»¶ä¸­\n\n***ç°åœ¨ä½ å¯ä»¥ä½¿ç”¨èŠå¤©æ¥â€œå¯¹â€ä½ çš„æ•°æ®è¯´è¯å•¦ï¼*** ğŸ‰\n",
        "height": 466,
        "width": 1385,
        "color": 3
      },
      "id": "9ecb3545-8e62-4b52-9687-822f8306beac",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        0,
        0
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "jsCode": "// è·å–å‰ä¸€æ­¥AI AgentèŠ‚ç‚¹çš„è¾“å‡ºæ•°æ®\nconst aiOutput = $input.first().json;\n\n// æå–å¹¶æ¸…ç†markdownå†…å®¹\nlet markdownContent = aiOutput.output;\nif (markdownContent.includes('```markdown')) {\n  markdownContent = markdownContent.replace(/```markdown\\s*/, '').replace(/\\\\s*```$/, '');\n}\n\n// ============ æ ¸å¿ƒä¼˜åŒ–ï¼šé’‰é’‰/ä¼ä¸šå¾®ä¿¡ Markdown å…¼å®¹+æ’ç‰ˆç¾åŒ–å¤„ç† å¼€å§‹ ============\nmarkdownContent = markdownContent\n  // 1. é’‰é’‰ä¸æ”¯æŒä¸€çº§æ ‡é¢˜ï¼Œ# æ›¿æ¢ä¸º ## ï¼ŒäºŒçº§æ ‡é¢˜###ä¿ç•™\n  .replace(/^# /gm, '## ')\n  // 2. å»æ‰é’‰é’‰ä¸å…¼å®¹çš„>å¼•ç”¨å—ï¼Œæ›¿æ¢ä¸ºåŠ ç²—æ ‡é¢˜\n  .replace(/> \\*\\*æ€»ç»“\\*\\*ï¼š/g, '### æ€»ç»“ï¼š')\n  // 3. æŠŠæ‰€æœ‰ *   å¼€å¤´çš„åˆ—è¡¨ï¼Œç»Ÿä¸€æ”¹ä¸º - å¼€å¤´ï¼ˆé’‰é’‰å¯¹ - åˆ—è¡¨æ”¯æŒæœ€å¥½ï¼‰\n  .replace(/\\n\\*   /g, '\\n- ')\n  // 4. ç»™æ¯ä¸ªäº§å“ä¿¡æ¯ååŠ ç©ºè¡Œï¼Œè§£å†³æ‹¥æŒ¤é—®é¢˜\n  .replace(/ã€‚\\n/g, 'ã€‚\\n\\n')\n  // 5. æ›¿æ¢ä¸­æ–‡åŒå¼•å·ä¸ºè‹±æ–‡åŒå¼•å·ï¼Œé¿å…é’‰é’‰æ˜¾ç¤ºä¹±ç \n  .replace(/â€œ/g, '\"').replace(/â€/g, '\"')\n  // 6. å¢åŠ åˆç†çš„è¡Œé—´è·ï¼Œè®©å†…å®¹ä¸æ‹¥æŒ¤\n  .replace(/\\n\\n+/g, '\\n\\n');\n// ============ æ ¸å¿ƒä¼˜åŒ– ç»“æŸ ============\n\n// æ„å»ºé’‰é’‰/ä¼ä¸šå¾®ä¿¡ã€Œç¾¤èŠæœºå™¨äººã€æ‰€éœ€çš„JSONæ ¼å¼\nconst botMessage = {\n  \"msgtype\": \"markdown\",\n  \"markdown\": {\n    \"content\": markdownContent\n  }\n};\n\n// è¾“å‡ºç»™HTTP RequestèŠ‚ç‚¹\nreturn botMessage;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2240,
        640
      ],
      "id": "7e220e96-8d61-410d-9b6e-16926e8e171a",
      "name": "covert msg to markdown"
    },
    {
      "parameters": {
        "language": "python",
        "pythonCode": "import time\nimport hmac\nimport hashlib\nimport base64\nimport urllib.parse\n\n\nfor item in _input.all():\n  timestamp = str(round(time.time() * 1000))\n  secret = 'SECcf5a5f6c6a66e10532471b138ef24e8322f6cf16ae50a3669aa27c3cb4471c46'\n  secret_enc = secret.encode('utf-8')\n  string_to_sign = '{}\\n{}'.format(timestamp, secret)\n  string_to_sign_enc = string_to_sign.encode('utf-8')\n  hmac_code = hmac.new(secret_enc, string_to_sign_enc, digestmod=hashlib.sha256).digest()\n  sign = urllib.parse.quote_plus(base64.b64encode(hmac_code))\n  item.json.timestamp = timestamp\n  item.json.sign = sign \nreturn _input.all()"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2464,
        640
      ],
      "id": "1344f159-1446-4031-b947-4f7a5c691b6d",
      "name": "sign dingding data"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://qyapi.weixin.qq.com/cgi-bin/webhook/send",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "key",
              "value": "a5450767-ad81-4dd6-b0a2-fa3074ea4811"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"msgtype\": \"markdown\",\n    \"markdown\": {\n        \"content\": {{ $json.markdown.content.toJsonString() }}\n    }\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        2240,
        464
      ],
      "id": "1368baf0-b8cb-414c-a60e-9873f500f4c7",
      "name": "Send msg to wechat"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://oapi.dingtalk.com/robot/send?access_token=31215f5d1c8320f58a8cc367bcda71f9c2610b7fbd2708b8b9307fdb7b845fda",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "timestamp",
              "value": "={{ $json.timestamp }}"
            },
            {
              "name": "=sign",
              "value": "={{ $json.sign }}"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n     \"msgtype\": \"markdown\",\n     \"markdown\": {\n         \"title\":\"æ™ºèƒ½AIæ¨é€\",\n         \"text\": {{ $json.markdown.content.toJsonString() }}\n    },\n      \"at\": {\n          \"atMobiles\": [],\n          \"atUserIds\": [],\n          \"isAtAll\": true\n      }\n }",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        2720,
        640
      ],
      "id": "62744bc7-4e22-463c-af79-d084b4c18cb4",
      "name": "Send msg to dingding"
    },
    {
      "parameters": {
        "jsCode": "// ===================== N8N ä¸‡èƒ½æ•°æ®ç»Ÿè®¡è®¡ç®—å™¨ - å®Œç¾å…¼å®¹ã€æ•°é‡/æ€»æ•°é‡ã€‘ç»ˆæç‰ˆ =====================\n// âœ… æ ¸å¿ƒä¿®å¤ï¼šå®Œç¾å…¼å®¹ã€Œæ•°é‡ã€ã€Œæ€»æ•°é‡ã€åŒå­—æ®µï¼Œä¼˜å…ˆçº§ç½®é¡¶ï¼Œå½»åº•è§£å†³åŒ¹é…é—®é¢˜\n// âœ… å®Œç¾é€‚é…æ‰€æœ‰åœºæ™¯ï¼šäº§é‡ç»Ÿè®¡/åŒæœˆå¯¹æ¯”/åº“æˆ¿åº“å­˜/å‡ºå…¥åº“æµæ°´/ä¿è´¨æœŸæŸ¥è¯¢/é‡é‡ç»Ÿä¸€æŒ‰æ•°é‡ç»Ÿè®¡\n// âœ… æ ¸å¿ƒç‰¹æ€§ï¼šè‡ªåŠ¨è¿‡æ»¤0åº“å­˜+æ•°å€¼å…œåº•é˜²NaN+å¤šç»´åº¦åˆ†ç»„ç»Ÿè®¡+ç²¾å‡†ä¿ç•™2ä½å°æ•°+æ— ä»»ä½•æŠ¥é”™\nconst rawData = $input.all().map(item => item.json);\nconst validData = rawData.filter(item => item && Object.keys(item).length > 0 && JSON.stringify(item) !== '{}');\n\nconst getFieldType = (value) => {\n  if (value === null || value === undefined || value === '' || typeof value === 'boolean') return 'empty';\n  const valStr = String(value).trim();\n  const isMonthFormat = /^\\d{4}-\\d{2}$/.test(valStr);\n  const isDateFormat = /^\\d{4}-\\d{2}-\\d{2}$/.test(valStr);\n  if (isMonthFormat || isDateFormat) return 'text';\n  const numVal = parseFloat(valStr);\n  return !isNaN(numVal) ? 'number' : 'text';\n};\n\nconst allFields = validData.length > 0 ? Object.keys(validData[0]) : [];\nconst textFields = allFields.filter(field => getFieldType(validData[0][field]) === 'text');\nconst numberFields = allFields.filter(field => getFieldType(validData[0][field]) === 'number');\n\nconst hasUnitField = textFields.includes('å•ä½') || textFields.includes('æ•°é‡å•ä½');\nconst unitKey = textFields.includes('æ•°é‡å•ä½') ? 'æ•°é‡å•ä½' : 'å•ä½';\n\nconst hasProduct = textFields.includes('äº§å“åç§°');\nconst hasWarehouse = textFields.includes('åº“æˆ¿åç§°');\nconst hasCurrStock = numberFields.includes('å½“å‰æ•°é‡');\nconst hasInOutStock = numberFields.includes('æ€»å…¥åº“æ•°é‡') || numberFields.includes('æ€»å‡ºåº“æ•°é‡');\nconst hasExpStatus = textFields.includes('ä¿è´¨æœŸçŠ¶æ€');\nconst hasInOutDir = textFields.includes('å‡ºå…¥åº“æ–¹å‘');\n// âœ… æ ¸å¿ƒä¿®æ”¹1ï¼šåŒæ—¶å…¼å®¹ã€Œæ€»æ•°é‡ã€ã€Œæ•°é‡ã€ï¼Œä¼˜å…ˆçº§ç½®é¡¶ï¼Œäº§é‡/é‡é‡å…¨éƒ¨æŒ‰æ•°é‡ç»Ÿè®¡\nconst hasMonthTotal = numberFields.includes('æ€»æ•°é‡') || numberFields.includes('æ•°é‡');\nconst hasRecordCount = numberFields.includes('äº§å“è®°å½•æ•°');\nconst hasStatMonth = textFields.includes('ç»Ÿè®¡æœˆä»½');\n\n// âœ… æ ¸å¿ƒä¿®æ”¹2ï¼šä¼˜å…ˆçº§æ’åº æ€»æ•°é‡ > æ•°é‡ > å½“å‰æ•°é‡ > æ€»å…¥åº“æ•°é‡ å®Œç¾å…¼å®¹æ‰€æœ‰æ•°å€¼å­—æ®µ\nconst countField = numberFields.includes('æ€»æ•°é‡') ? 'æ€»æ•°é‡' : \n                  numberFields.includes('æ•°é‡') ? 'æ•°é‡' : \n                  numberFields.includes('å½“å‰æ•°é‡') ? 'å½“å‰æ•°é‡' : \n                  numberFields.includes('æ€»å…¥åº“æ•°é‡') ? 'æ€»å…¥åº“æ•°é‡' : 'æ•°é‡';\n\nlet calcResult = {};\n\nif (hasProduct && hasWarehouse && hasUnitField && hasMonthTotal && hasInOutDir && hasStatMonth && !hasCurrStock && !hasInOutStock) {\n  const filterValidData = validData.filter(item => {\n    const totalNum = parseFloat(item[countField]) || 0;\n    const inOutDir = item['å‡ºå…¥åº“æ–¹å‘'];\n    const statMonth = item['ç»Ÿè®¡æœˆä»½'];\n    return totalNum > 0 && inOutDir && ['å…¥åº“','å‡ºåº“'].includes(inOutDir) && statMonth && /^\\d{4}-\\d{2}$/.test(statMonth);\n  });\n\n  const allStatMonths = [...new Set(filterValidData.map(item => item['ç»Ÿè®¡æœˆä»½']))].sort((a,b) => b.localeCompare(a));\n  const isCompareMode = allStatMonths.length >= 2;\n  const mainMonth = allStatMonths[0];\n  const prevMonth = allStatMonths[1] || '';\n\n  const inStockData = filterValidData.filter(item => item['å‡ºå…¥åº“æ–¹å‘'] === 'å…¥åº“');\n  const outStockData = filterValidData.filter(item => item['å‡ºå…¥åº“æ–¹å‘'] === 'å‡ºåº“');\n\n  const productGroup = {};\n  filterValidData.forEach(item => {\n    const product = item['äº§å“åç§°'];\n    if (!productGroup[product]) productGroup[product] = [];\n    productGroup[product].push(item);\n  });\n\n  const warehouseGroup = {};\n  filterValidData.forEach(item => {\n    const warehouse = item['åº“æˆ¿åç§°'];\n    if (!warehouseGroup[warehouse]) warehouseGroup[warehouse] = [];\n    warehouseGroup[warehouse].push(item);\n  });\n\n  const getGlobalSummary = () => {\n    if(!isCompareMode){\n      const inTotal = parseFloat(inStockData.reduce((sum, item) => sum + (parseFloat(item[countField]) || 0), 0).toFixed(2));\n      const outTotal = parseFloat(outStockData.reduce((sum, item) => sum + (parseFloat(item[countField]) || 0), 0).toFixed(2));\n      return {\n        ç»Ÿè®¡æœˆä»½: mainMonth,\n        æœ¬æœˆäº§å“å…¥åº“æ€»æ•°é‡: inTotal,\n        æœ¬æœˆäº§å“å‡ºåº“æ€»æ•°é‡: outTotal,\n        å…¥åº“äº§å“è®°å½•æ€»æ¡æ•°: inStockData.length,\n        å‡ºåº“äº§å“è®°å½•æ€»æ¡æ•°: outStockData.length,\n        æ¶‰åŠäº§å“æ€»ç§ç±»æ•°: Object.keys(productGroup).length,\n        æ¶‰åŠåº“æˆ¿æ€»æ•°é‡: Object.keys(warehouseGroup).length\n      };\n    }else{\n      const currInData = inStockData.filter(item => item['ç»Ÿè®¡æœˆä»½'] === mainMonth);\n      const currOutData = outStockData.filter(item => item['ç»Ÿè®¡æœˆä»½'] === mainMonth);\n      const prevInData = inStockData.filter(item => item['ç»Ÿè®¡æœˆä»½'] === prevMonth);\n      const prevOutData = outStockData.filter(item => item['ç»Ÿè®¡æœˆä»½'] === prevMonth);\n\n      const currInTotal = parseFloat(currInData.reduce((sum, item) => sum + (parseFloat(item[countField]) || 0), 0).toFixed(2));\n      const currOutTotal = parseFloat(currOutData.reduce((sum, item) => sum + (parseFloat(item[countField]) || 0), 0).toFixed(2));\n      const prevInTotal = parseFloat(prevInData.reduce((sum, item) => sum + (parseFloat(item[countField]) || 0), 0).toFixed(2));\n      const prevOutTotal = parseFloat(prevOutData.reduce((sum, item) => sum + (parseFloat(item[countField]) || 0), 0).toFixed(2));\n\n      const inDiff = parseFloat((currInTotal - prevInTotal).toFixed(2));\n      const outDiff = parseFloat((currOutTotal - prevOutTotal).toFixed(2));\n      const inRate = prevInTotal === 0 ? 0 : parseFloat(((inDiff / prevInTotal) * 100).toFixed(2));\n      const outRate = prevOutTotal === 0 ? 0 : parseFloat(((outDiff / prevOutTotal) * 100).toFixed(2));\n\n      return {\n        å¯¹æ¯”ç»´åº¦: `${mainMonth}(æœ¬æœˆ) VS ${prevMonth}(ä¸Šæœˆ)`,\n        æœ¬æœˆå…¥åº“æ€»æ•°é‡: currInTotal,\n        æœ¬æœˆå‡ºåº“æ€»æ•°é‡: currOutTotal,\n        ä¸Šæœˆå…¥åº“æ€»æ•°é‡: prevInTotal,\n        ä¸Šæœˆå‡ºåº“æ€»æ•°é‡: prevOutTotal,\n        å…¥åº“æ•°é‡å¢å‡é‡: inDiff,\n        å…¥åº“å¢é•¿ç‡: `${inRate}%`,\n        å‡ºåº“æ•°é‡å¢å‡é‡: outDiff,\n        å‡ºåº“å¢é•¿ç‡: `${outRate}%`,\n        æ¶‰åŠäº§å“æ€»ç§ç±»æ•°: Object.keys(productGroup).length,\n        æ¶‰åŠåº“æˆ¿æ€»æ•°é‡: Object.keys(warehouseGroup).length\n      };\n    }\n  };\n\n  const getProductGroup = () => {\n    const result = {};\n    Object.keys(productGroup).forEach(product => {\n      const productData = productGroup[product];\n      const prodType = productData[0]['äº§å“ç±»å‹'] || 'æœªçŸ¥ç±»å‹';\n      const unit = productData[0][unitKey] || 'æœªçŸ¥å•ä½';\n      if(!isCompareMode){\n        const inData = productData.filter(item => item['å‡ºå…¥åº“æ–¹å‘'] === 'å…¥åº“');\n        const outData = productData.filter(item => item['å‡ºå…¥åº“æ–¹å‘'] === 'å‡ºåº“');\n        const inTotal = parseFloat(inData.reduce((sum, item) => sum + (parseFloat(item[countField]) || 0), 0).toFixed(2));\n        const outTotal = parseFloat(outData.reduce((sum, item) => sum + (parseFloat(item[countField]) || 0), 0).toFixed(2));\n        result[product] = {\n          äº§å“åç§°: product,\n          äº§å“ç±»å‹: prodType,\n          æ•°é‡å•ä½: unit,\n          ç»Ÿè®¡æœˆä»½: mainMonth,\n          å…¥åº“æ€»æ•°é‡: inTotal,\n          å‡ºåº“æ€»æ•°é‡: outTotal,\n          æ¶‰åŠåº“æˆ¿: [...new Set(productData.map(item => item['åº“æˆ¿åç§°']))],\n          æ˜ç»†æ•°æ®: productData\n        };\n      }else{\n        const currIn = parseFloat(productData.filter(item => item['ç»Ÿè®¡æœˆä»½']===mainMonth && item['å‡ºå…¥åº“æ–¹å‘']==='å…¥åº“').reduce((sum,item)=>sum+(parseFloat(item[countField])||0),0).toFixed(2));\n        const currOut = parseFloat(productData.filter(item => item['ç»Ÿè®¡æœˆä»½']===mainMonth && item['å‡ºå…¥åº“æ–¹å‘']==='å‡ºåº“').reduce((sum,item)=>sum+(parseFloat(item[countField])||0),0).toFixed(2));\n        const prevIn = parseFloat(productData.filter(item => item['ç»Ÿè®¡æœˆä»½']===prevMonth && item['å‡ºå…¥åº“æ–¹å‘']==='å…¥åº“').reduce((sum,item)=>sum+(parseFloat(item[countField])||0),0).toFixed(2));\n        const prevOut = parseFloat(productData.filter(item => item['ç»Ÿè®¡æœˆä»½']===prevMonth && item['å‡ºå…¥åº“æ–¹å‘']==='å‡ºåº“').reduce((sum,item)=>sum+(parseFloat(item[countField])||0),0).toFixed(2));\n        const inDiff = parseFloat((currIn - prevIn).toFixed(2));\n        const outDiff = parseFloat((currOut - prevOut).toFixed(2));\n        const inRate = prevIn ===0 ? 0 : parseFloat(((inDiff/prevIn)*100).toFixed(2));\n        const outRate = prevOut ===0 ? 0 : parseFloat(((outDiff/prevOut)*100).toFixed(2));\n        result[product] = {\n          äº§å“åç§°: product,\n          äº§å“ç±»å‹: prodType,\n          æ•°é‡å•ä½: unit,\n          æœ¬æœˆå…¥åº“æ•°é‡: currIn,\n          æœ¬æœˆå‡ºåº“æ•°é‡: currOut,\n          ä¸Šæœˆå…¥åº“æ•°é‡: prevIn,\n          ä¸Šæœˆå‡ºåº“æ•°é‡: prevOut,\n          å…¥åº“å¢å‡é‡: inDiff,\n          å…¥åº“å¢é•¿ç‡: `${inRate}%`,\n          å‡ºåº“å¢å‡é‡: outDiff,\n          å‡ºåº“å¢é•¿ç‡: `${outRate}%`,\n          æ¶‰åŠåº“æˆ¿: [...new Set(productData.map(item => item['åº“æˆ¿åç§°']))],\n          æ˜ç»†æ•°æ®: productData\n        };\n      }\n    });\n    return Object.values(result).sort((a,b) => (b.æœ¬æœˆå…¥åº“æ•°é‡ || b.å…¥åº“æ€»æ•°é‡) - (a.æœ¬æœˆå…¥åº“æ•°é‡ || a.å…¥åº“æ€»æ•°é‡));\n  };\n\n  const getWarehouseGroup = () => {\n    const result = {};\n    Object.keys(warehouseGroup).forEach(warehouse => {\n      const wareData = warehouseGroup[warehouse];\n      if(!isCompareMode){\n        const inTotal = parseFloat(wareData.filter(item => item['å‡ºå…¥åº“æ–¹å‘']==='å…¥åº“').reduce((sum,item)=>sum+(parseFloat(item[countField])||0),0).toFixed(2));\n        const outTotal = parseFloat(wareData.filter(item => item['å‡ºå…¥åº“æ–¹å‘']==='å‡ºåº“').reduce((sum,item)=>sum+(parseFloat(item[countField])||0),0).toFixed(2));\n        result[warehouse] = {\n          åº“æˆ¿åç§°: warehouse,\n          ç»Ÿè®¡æœˆä»½: mainMonth,\n          å…¥åº“æ€»æ•°é‡: inTotal,\n          å‡ºåº“æ€»æ•°é‡: outTotal,\n          äº§å“ç§ç±»æ•°: [...new Set(wareData.map(item => item['äº§å“åç§°']))].length,\n          æ˜ç»†æ•°æ®: wareData\n        };\n      }else{\n        const currIn = parseFloat(wareData.filter(item => item['ç»Ÿè®¡æœˆä»½']===mainMonth && item['å‡ºå…¥åº“æ–¹å‘']==='å…¥åº“').reduce((sum,item)=>sum+(parseFloat(item[countField])||0),0).toFixed(2));\n        const currOut = parseFloat(wareData.filter(item => item['ç»Ÿè®¡æœˆä»½']===mainMonth && item['å‡ºå…¥åº“æ–¹å‘']==='å‡ºåº“').reduce((sum,item)=>sum+(parseFloat(item[countField])||0),0).toFixed(2));\n        const prevIn = parseFloat(wareData.filter(item => item['ç»Ÿè®¡æœˆä»½']===prevMonth && item['å‡ºå…¥åº“æ–¹å‘']==='å…¥åº“').reduce((sum,item)=>sum+(parseFloat(item[countField])||0),0).toFixed(2));\n        const prevOut = parseFloat(wareData.filter(item => item['ç»Ÿè®¡æœˆä»½']===prevMonth && item['å‡ºå…¥åº“æ–¹å‘']==='å‡ºåº“').reduce((sum,item)=>sum+(parseFloat(item[countField])||0),0).toFixed(2));\n        result[warehouse] = {\n          åº“æˆ¿åç§°: warehouse,\n          æœ¬æœˆå…¥åº“æ•°é‡: currIn,\n          æœ¬æœˆå‡ºåº“æ•°é‡: currOut,\n          ä¸Šæœˆå…¥åº“æ•°é‡: prevIn,\n          ä¸Šæœˆå‡ºåº“æ•°é‡: prevOut,\n          å…¥åº“å¢å‡é‡: parseFloat((currIn - prevIn).toFixed(2)),\n          å‡ºåº“å¢å‡é‡: parseFloat((currOut - prevOut).toFixed(2)),\n          äº§å“ç§ç±»æ•°: [...new Set(wareData.map(item => item['äº§å“åç§°']))].length,\n          æ˜ç»†æ•°æ®: wareData\n        };\n      }\n    });\n    return Object.values(result).sort((a,b) => (b.æœ¬æœˆå…¥åº“æ•°é‡ || b.å…¥åº“æ€»æ•°é‡) - (a.æœ¬æœˆå…¥åº“æ•°é‡ || a.å…¥åº“æ€»æ•°é‡));\n  };\n\n  calcResult = {\n    baseInfo: {\n      dataType: isCompareMode ? \"äº§é‡å¯¹æ¯”ç»Ÿè®¡ã€æœ¬æœˆVSä¸Šæœˆ | ä¸¥æ ¼åŒºåˆ†å…¥åº“å‡ºåº“ã€‘\" : \"å•æœˆäº§é‡ç»Ÿè®¡ã€ä¸¥æ ¼åŒºåˆ†å…¥åº“å‡ºåº“ã€‘\",\n      dataRowCount: validData.length,\n      validDataRow: filterValidData.length,\n      statisticMode: isCompareMode ? \"åŒæœˆå¯¹æ¯”æ¨¡å¼\" : \"å•æœˆç»Ÿè®¡æ¨¡å¼\",\n      dimensionFields: textFields,\n      statisticFields: numberFields\n    },\n    globalSummary: getGlobalSummary(),\n    groupByProduct: getProductGroup(),\n    groupByWarehouse: getWarehouseGroup(),\n    validDetailData: filterValidData,\n    inStockDetail: inStockData,\n    outStockDetail: outStockData\n  };\n\n// âœ… âœ… âœ… æ ¸å¿ƒä¿®å¤åŒºåŸŸï¼šåº“æˆ¿å®æ—¶åº“å­˜é™æ€æ•°æ® - å½»åº•è§£å†³æ‰§è¡Œæ—¶æœºé—®é¢˜ï¼Œæ— ä»»ä½•æŠ¥é”™ âœ… âœ… âœ…\n} else if (hasProduct && hasWarehouse && hasCurrStock && hasUnitField && !hasInOutStock && !hasExpStatus) {\n  const filterValidData = validData.filter(item => item[countField] !== null && item[countField] !== undefined && parseFloat(item[countField]) > 0);\n  const unitGroup = {};\n  filterValidData.forEach(item => {\n    const unit = item[unitKey];\n    if (!unitGroup[unit]) unitGroup[unit] = [];\n    unitGroup[unit].push(item);\n  });\n\n  calcResult = {\n    baseInfo: {\n      dataType: \"åº“æˆ¿å®æ—¶åº“å­˜é™æ€æ•°æ®ã€æ ¸å¿ƒä¸šåŠ¡ã€‘\",\n      dataRowCount: validData.length,\n      validStockRow: filterValidData.length,\n      dimensionFields: textFields,\n      statisticFields: numberFields,\n      unitField: unitKey,\n      countField: countField,\n      isEmpty: filterValidData.length === 0\n    },\n    globalStockTotal: {\n      æ€»æœ‰æ•ˆåº“å­˜äº§å“æ•°: filterValidData.length,\n      æ¶‰åŠåº“æˆ¿æ€»æ•°: [...new Set(filterValidData.map(item => item['åº“æˆ¿åç§°']))].length,\n      æ¶‰åŠäº§å“æ€»ç§ç±»æ•°: [...new Set(filterValidData.map(item => item['äº§å“åç§°']))].length,\n      æ¶‰åŠè®¡é‡å•ä½æ•°: Object.keys(unitGroup).length,\n      å„å•ä½åº“å­˜æ±‡æ€»: {}\n    },\n    groupByUnit: {},\n    validDetailData: filterValidData\n  };\n\n  const unitResult = {};\n  const unitSummary = {};\n  Object.keys(unitGroup).forEach(unit => {\n    const unitData = unitGroup[unit];\n    const totalQty = unitData.reduce((sum, item) => sum + (parseFloat(item[countField]) || 0), 0).toFixed(2)*1;\n    unitResult[unit] = {\n      è®¡é‡å•ä½: unit,\n      è¯¥å•ä½äº§å“æ•°: unitData.length,\n      è¯¥å•ä½åº“å­˜æ€»é‡: totalQty,\n      groupByWarehouse: (() => {\n        const warehouseGroup = {};\n        unitData.forEach(item => {\n          const warehouse = item['åº“æˆ¿åç§°'];\n          if (!warehouseGroup[warehouse]) warehouseGroup[warehouse] = {åº“æˆ¿åç§°: warehouse,åº“å­˜æ€»é‡:0,äº§å“æ˜ç»†:[]};\n          warehouseGroup[warehouse].åº“å­˜æ€»é‡ += (parseFloat(item[countField]) || 0);\n          warehouseGroup[warehouse].äº§å“æ˜ç»†.push(item);\n        });\n        return Object.values(warehouseGroup).sort((a,b)=>b.åº“å­˜æ€»é‡ - a.åº“å­˜æ€»é‡);\n      })(),\n      groupByProduct: (() => {\n        const productGroup = {};\n        unitData.forEach(item => {\n          const product = item['äº§å“åç§°'];\n          if (!productGroup[product]) productGroup[product] = {äº§å“åç§°: product,åº“å­˜æ€»é‡:0,æ¶‰åŠåº“æˆ¿:[],å­˜æ”¾ä½ç½®:[]};\n          productGroup[product].åº“å­˜æ€»é‡ += (parseFloat(item[countField]) || 0);\n          if(!productGroup[product].æ¶‰åŠåº“æˆ¿.includes(item['åº“æˆ¿åç§°'])) productGroup[product].æ¶‰åŠåº“æˆ¿.push(item['åº“æˆ¿åç§°']);\n          if(item['å­˜æ”¾ä½ç½®'] && !productGroup[product].å­˜æ”¾ä½ç½®.includes(item['å­˜æ”¾ä½ç½®'])) productGroup[product].å­˜æ”¾ä½ç½®.push(item['å­˜æ”¾ä½ç½®']);\n        });\n        return Object.values(productGroup).sort((a,b)=>b.åº“å­˜æ€»é‡ - a.åº“å­˜æ€»é‡);\n      })(),\n      detailData: unitData\n    };\n    unitSummary[unit] = totalQty;\n  });\n\n  calcResult.groupByUnit = unitResult;\n  calcResult.globalStockTotal.å„å•ä½åº“å­˜æ±‡æ€» = unitSummary;\n\n} else if (hasExpStatus && hasProduct && hasCurrStock && hasUnitField) {\n  const filterValidData = validData.filter(item => item[countField] !== null && item[countField] !== undefined && parseFloat(item[countField]) > 0);\n  calcResult = {\n    baseInfo: {\n      dataType: \"åº“å­˜äº§å“ä¿è´¨æœŸæ˜ç»†æ•°æ®\",\n      dataRowCount: validData.length,\n      validCountRow: filterValidData.length,\n      dimensionFields: textFields,\n      statisticFields: numberFields,\n      countField: countField,\n      unitField: unitKey,\n      isEmpty: filterValidData.length === 0\n    },\n    groupByExpStatus: (() => {\n      const statusGroup = {};\n      filterValidData.forEach(item => {\n        const expStatus = item['ä¿è´¨æœŸçŠ¶æ€'];\n        if (!statusGroup[expStatus]) statusGroup[expStatus] = [];\n        statusGroup[expStatus].push(item);\n      });\n      Object.keys(statusGroup).forEach(status => {\n        const statusData = statusGroup[status];\n        const statusResult = {\n          ä¿è´¨æœŸçŠ¶æ€: status,\n          æ•°æ®æ¡æ•°: statusData.length,\n          è¯¥çŠ¶æ€æ€»æ•°é‡: statusData.reduce((sum, item) => sum + (parseFloat(item[countField]) || 0), 0).toFixed(2)*1,\n          å•ä½: statusData[0][unitKey],\n          groupByProduct: [],\n          groupByWarehouse: [],\n          detailList: statusData\n        };\n        if (hasProduct) {\n          const productGroup = {};\n          statusData.forEach(item => {\n            const productName = item['äº§å“åç§°'];\n            if (!productGroup[productName]) {\n              productGroup[productName] = {äº§å“åç§°: productName,å•ä½: item[unitKey],æ€»æ•°é‡:0};\n            }\n            productGroup[productName].æ€»æ•°é‡ += (parseFloat(item[countField]) || 0);\n          });\n          statusResult.groupByProduct = Object.values(productGroup).filter(p => p.æ€»æ•°é‡>0).sort((a,b)=>b.æ€»æ•°é‡-a.æ€»æ•°é‡);\n        }\n        if (hasWarehouse) {\n          const warehouseGroup = {};\n          statusData.forEach(item => {\n            const warehouseName = item['åº“æˆ¿åç§°'] || 'æ— åº“æˆ¿';\n            if (!warehouseGroup[warehouseName]) warehouseGroup[warehouseName] = {åº“æˆ¿åç§°: warehouseName,å•ä½: item[unitKey],æ€»æ•°é‡:0};\n            warehouseGroup[warehouseName].æ€»æ•°é‡ += (parseFloat(item[countField]) || 0);\n          });\n          statusResult.groupByWarehouse = Object.values(warehouseGroup).filter(w => w.æ€»æ•°é‡>0).sort((a,b)=>b.æ€»æ•°é‡-a.æ€»æ•°é‡);\n        }\n        statusGroup[status] = statusResult;\n      });\n      return statusGroup;\n    })(),\n    totalSummary: {\n      åº“å­˜äº§å“æ€»æ•°é‡: filterValidData.reduce((sum, item) => sum + (parseFloat(item[countField]) || 0), 0).toFixed(2)*1,\n      å·²è¿‡æœŸäº§å“æ€»æ•°é‡: filterValidData.filter(item=>item['ä¿è´¨æœŸçŠ¶æ€']==='å·²è¿‡æœŸ').reduce((sum,item)=>sum+(parseFloat(item[countField])||0),0).toFixed(2)*1,\n      æ­£å¸¸ä¿è´¨æœŸäº§å“æ€»æ•°é‡: filterValidData.filter(item=>item['ä¿è´¨æœŸçŠ¶æ€']==='æ­£å¸¸').reduce((sum,item)=>sum+(parseFloat(item[countField])||0),0).toFixed(2)*1,\n      å·²è¿‡æœŸäº§å“å æ¯”: filterValidData.length>0 ? `${((filterValidData.filter(item=>item['ä¿è´¨æœŸçŠ¶æ€']==='å·²è¿‡æœŸ').reduce((sum,item)=>sum+(parseFloat(item[countField])||0),0)/filterValidData.reduce((sum,item)=>sum+(parseFloat(item[countField])||0),0))*100).toFixed(2)}%` : '0%'\n    }\n  };\n\n} else if (hasProduct && hasInOutStock && (hasWarehouse || hasInOutDir)) {\n  const filterValidData = validData.filter(item => {\n    const inNum = parseFloat(item['æ€»å…¥åº“æ•°é‡'] || 0);\n    const outNum = parseFloat(item['æ€»å‡ºåº“æ•°é‡'] || 0);\n    return inNum + outNum > 0;\n  });\n  calcResult = {\n    baseInfo: {\n      dataType: \"åº“å­˜å‡ºå…¥åº“æ˜ç»†æ•°æ®ã€æ— å•ä½ã€‘\",\n      dataRowCount: validData.length,\n      validCountRow: filterValidData.length,\n      dimensionFields: textFields,\n      statisticFields: numberFields,\n      isEmpty: filterValidData.length === 0\n    },\n    globalTotal: {\n      å…¨åº“æˆ¿æ€»å…¥åº“æ•°é‡: filterValidData.reduce((sum, item) => sum + (parseFloat(item['æ€»å…¥åº“æ•°é‡']) || 0), 0).toFixed(2)*1,\n      å…¨åº“æˆ¿æ€»å‡ºåº“æ•°é‡: filterValidData.reduce((sum, item) => sum + (parseFloat(item['æ€»å‡ºåº“æ•°é‡']) || 0), 0).toFixed(2)*1,\n      æ€»å…¥åº“è®°å½•æ•°: filterValidData.reduce((sum, item) => sum + parseInt(item['å…¥åº“è®°å½•æ•°'] || 0), 0),\n      æ€»å‡ºåº“è®°å½•æ•°: filterValidData.reduce((sum, item) => sum + parseInt(item['å‡ºåº“è®°å½•æ•°'] || 0), 0),\n      æœ‰æ•ˆäº§å“æ€»æ•°: filterValidData.length,\n      æ¶‰åŠåº“æˆ¿æ•°: [...new Set(filterValidData.map(item => item['åº“æˆ¿åç§°']))].length,\n      æ¶‰åŠäº§å“ç§ç±»æ•°: [...new Set(filterValidData.map(item => item['äº§å“åç§°']))].length\n    },\n    groupByProduct: (() => {\n      const productGroup = {};\n      filterValidData.forEach(item => {\n        const productName = item['äº§å“åç§°'];\n        if (!productGroup[productName]) {\n          productGroup[productName] = {\n            äº§å“åç§°: productName,\n            åˆå¹¶æ€»å…¥åº“æ•°é‡: 0,\n            åˆå¹¶æ€»å‡ºåº“æ•°é‡: 0,\n            åˆå¹¶å…¥åº“è®°å½•æ•°:0,\n            åˆå¹¶å‡ºåº“è®°å½•æ•°:0,\n            æ¶‰åŠåº“æˆ¿: [],\n            åº“æˆ¿æ˜ç»†: []\n          };\n        }\n        productGroup[productName].åˆå¹¶æ€»å…¥åº“æ•°é‡ += (parseFloat(item['æ€»å…¥åº“æ•°é‡']) || 0);\n        productGroup[productName].åˆå¹¶æ€»å‡ºåº“æ•°é‡ += (parseFloat(item['æ€»å‡ºåº“æ•°é‡']) || 0);\n        productGroup[productName].åˆå¹¶å…¥åº“è®°å½•æ•° += parseInt(item['å…¥åº“è®°å½•æ•°'] ||0);\n        productGroup[productName].åˆå¹¶å‡ºåº“è®°å½•æ•° += parseInt(item['å‡ºåº“è®°å½•æ•°'] ||0);\n        if(!productGroup[productName].æ¶‰åŠåº“æˆ¿.includes(item['åº“æˆ¿åç§°'])) productGroup[productName].æ¶‰åŠåº“æˆ¿.push(item['åº“æˆ¿åç§°']);\n        productGroup[productName].åº“æˆ¿æ˜ç»†.push({åº“æˆ¿åç§°: item['åº“æˆ¿åç§°'],å…¥åº“æ•°é‡: item['æ€»å…¥åº“æ•°é‡'],å‡ºåº“æ•°é‡: item['æ€»å‡ºåº“æ•°é‡']});\n      });\n      return Object.values(productGroup).sort((a,b) => b.åˆå¹¶æ€»å…¥åº“æ•°é‡ - a.åˆå¹¶æ€»å…¥åº“æ•°é‡);\n    })(),\n    groupByWarehouse: (() => {\n      const warehouseGroup = {};\n      filterValidData.forEach(item => {\n        const warehouseName = item['åº“æˆ¿åç§°'];\n        if (!warehouseGroup[warehouseName]) {\n          warehouseGroup[warehouseName] = {åº“æˆ¿åç§°: warehouseName,åº“æˆ¿æ€»å…¥åº“:0,åº“æˆ¿æ€»å‡ºåº“:0,äº§å“æ˜ç»†:[]};\n        }\n        warehouseGroup[warehouseName].åº“æˆ¿æ€»å…¥åº“ += (parseFloat(item['æ€»å…¥åº“æ•°é‡']) ||0);\n        warehouseGroup[warehouseName].åº“æˆ¿æ€»å‡ºåº“ += (parseFloat(item['æ€»å‡ºåº“æ•°é‡']) ||0);\n        warehouseGroup[warehouseName].äº§å“æ˜ç»†.push(item);\n      });\n      return Object.values(warehouseGroup).sort((a,b) => b.åº“æˆ¿æ€»å…¥åº“ - a.åº“æˆ¿æ€»å…¥åº“);\n    })(),\n    detailData: filterValidData\n  };\n\n} else {\n  calcResult = {\n    baseInfo: {\n      dataType: \"ç»Ÿè®¡æ±‡æ€»æ•°æ®(æœˆåº¦/å¹´åº¦/ç¯æ¯”ç­‰)\",\n      dataRowCount: validData.length,\n      dimensionFields: textFields,\n      statisticFields: numberFields,\n      isEmpty: validData.length === 0\n    },\n    statisticData: validData.map(item => {\n      const formatItem = {};\n      allFields.forEach(field => {\n        const fieldVal = item[field];\n        const type = getFieldType(fieldVal);\n        formatItem[field] = type === 'number' ? (parseFloat(fieldVal) || 0) : (fieldVal || '');\n      });\n      return formatItem;\n    })\n  };\n}\n\nif (calcResult.baseInfo?.isEmpty && validData.length === 0) {\n  calcResult = {isEmpty: true, msg: 'æœªæ‰¾åˆ°ç›¸å…³æ•°æ®'};\n}\n\nreturn calcResult;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1520,
        640
      ],
      "id": "432e8c4a-c7b7-41bb-b232-2f2ff9b8df3c",
      "name": "ä¸‡èƒ½æ•°æ®ç»Ÿè®¡è®¡ç®—å™¨"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "ding_talk",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -224,
        640
      ],
      "id": "edc907de-44dc-40b6-af65-d92209b766f6",
      "name": "Webhook",
      "webhookId": "184d0b3d-ee10-44a9-8286-949f60d80467"
    }
  ],
  "pinData": {},
  "connections": {
    "get msg from dingtalk": {
      "main": [
        [
          {
            "node": "Load the schema from the local file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Window Buffer Memory": {
      "ai_memory": [
        [
          {
            "node": "natural language to sql",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Add table name to output": {
      "main": [
        [
          {
            "node": "Convert data to Json",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract data from file": {
      "main": [
        [
          {
            "node": "Combine schema data and chat input",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When clicking \"Test workflow\"": {
      "main": [
        [
          {
            "node": "query tables name",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Combine schema data and chat input": {
      "main": [
        [
          {
            "node": "natural language to sql",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Load the schema from the local file": {
      "main": [
        [
          {
            "node": "Extract data from file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert data to Json": {
      "main": [
        [
          {
            "node": "Save file locally",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "query table column": {
      "main": [
        [
          {
            "node": "Add table name to output",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "query tables name": {
      "main": [
        [
          {
            "node": "query table column",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "DeepSeek Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "natural language to sql",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "natural language to sql": {
      "main": [
        [
          {
            "node": "sql query",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "sql query": {
      "main": [
        [
          {
            "node": "ä¸‡èƒ½æ•°æ®ç»Ÿè®¡è®¡ç®—å™¨",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "sql to natural language": {
      "main": [
        [
          {
            "node": "covert msg to markdown",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è‡ªç„¶è¯­è¨€chat": {
      "ai_languageModel": [
        [
          {
            "node": "sql to natural language",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "covert msg to markdown": {
      "main": [
        [
          {
            "node": "sign dingding data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "sign dingding data": {
      "main": [
        [
          {
            "node": "Send msg to dingding",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä¸‡èƒ½æ•°æ®ç»Ÿè®¡è®¡ç®—å™¨": {
      "main": [
        [
          {
            "node": "sql to natural language",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "get msg from dingtalk",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "5f1d29d4-525f-42c2-8eb6-5d7aff271eae",
  "meta": {
    "instanceId": "a2273711b4aea9d7d7574d8030e43adacae126bfdd44e135f1c866833d5f0aba"
  },
  "id": "nqP0bGpcGH6C0GmA",
  "tags": []
}