{
  "name": "åº“æˆ¿æ™ºèƒ½åŠ©æ‰‹",
  "nodes": [
    {
      "parameters": {
        "contextWindowLength": 10
      },
      "id": "2331c6f5-9b17-40be-adfd-9a87495206f2",
      "name": "Window Buffer Memory",
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "position": [
        1008,
        784
      ],
      "typeVersion": 1.2
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "232c4e0a-56d9-45bb-b9e2-d655ae424b89",
              "name": "",
              "value": "{{ $('query table column').item.json.table_name}}",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "id": "865d29d7-c998-4f8a-b63c-acde00e258b0",
      "name": "Add table name to output",
      "type": "n8n-nodes-base.set",
      "position": [
        640,
        224
      ],
      "typeVersion": 3.4
    },
    {
      "parameters": {
        "operation": "write",
        "fileName": "./assemblylinetest.json",
        "options": {}
      },
      "id": "46896315-6486-4a25-985c-70bc8bcb6999",
      "name": "Save file locally",
      "type": "n8n-nodes-base.readWriteFile",
      "position": [
        1088,
        224
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "operation": "fromJson",
        "options": {}
      },
      "id": "77bb883c-29ee-4f18-9a1e-7b025087aa4c",
      "name": "Extract data from file",
      "type": "n8n-nodes-base.extractFromFile",
      "position": [
        416,
        560
      ],
      "typeVersion": 1
    },
    {
      "parameters": {},
      "id": "30997f80-ada4-4228-b6bd-ad7e1422ec43",
      "name": "When clicking \"Test workflow\"",
      "type": "n8n-nodes-base.manualTrigger",
      "position": [
        -32,
        224
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "42abd24e-419a-47d6-bc8b-7146dd0b8314",
              "name": "sessionId",
              "type": "string",
              "value": "={{ $('Chat Trigger').first().json.sessionId }}"
            },
            {
              "id": "39244192-a1a6-42fe-bc75-a6fba1f264df",
              "name": "action",
              "type": "string",
              "value": "={{ $('Chat Trigger').first().json.action }}"
            },
            {
              "id": "f78c57d9-df13-43c7-89a7-5387e528107e",
              "name": "chatinput",
              "type": "string",
              "value": "={{ $('Chat Trigger').first().json.chatInput }}"
            },
            {
              "id": "e42b39eb-dfbd-48d9-94ed-d658bdd41454",
              "name": "schema",
              "type": "string",
              "value": "={{ $json.data }}"
            }
          ]
        },
        "options": {}
      },
      "id": "6f7af851-a563-4acd-8aab-adef775901d2",
      "name": "Combine schema data and chat input",
      "type": "n8n-nodes-base.set",
      "position": [
        640,
        560
      ],
      "executeOnce": true,
      "typeVersion": 3.4
    },
    {
      "parameters": {
        "fileSelector": "./assemblylinetest.json",
        "options": {}
      },
      "id": "5f441b2d-593a-4434-82b1-83486650f6ec",
      "name": "Load the schema from the local file",
      "type": "n8n-nodes-base.readWriteFile",
      "position": [
        192,
        560
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "operation": "toJson",
        "options": {}
      },
      "id": "2c8547f3-db1c-4a95-aa0f-f8a1fa542330",
      "name": "Convert data to Json",
      "type": "n8n-nodes-base.convertToFile",
      "position": [
        864,
        224
      ],
      "typeVersion": 1.1
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT \n  column_name, \n  data_type, \n  is_nullable, \n  column_default\nFROM information_schema.columns\nWHERE table_name  = '{{ $json.table_name }}'\n  AND table_schema = 'assemblylinetest'\nORDER BY ordinal_position;",
        "options": {}
      },
      "type": "n8n-nodes-base.mySql",
      "typeVersion": 2.5,
      "position": [
        416,
        224
      ],
      "id": "b65ae2c8-dbac-42fc-8d10-90349aaab8aa",
      "name": "query table column",
      "credentials": {
        "mySql": {
          "id": "5Z4JJVd4vFunfa9J",
          "name": "æµ‹è¯•æœåŠ¡å™¨"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT\n\ttable_name\nFROM\n\tinformation_schema. TABLES\nWHERE\n\tTABLE_schema = 'assemblylinetest'\nAND table_name IN (\n\t'final_storeroom_conf',\n\t'final_storeroom_store',\n\t'product_material',\n\t'stock_expired_time',\n\t'stock_log',\n\t'store',\n\t'storeroom'\n)",
        "options": {}
      },
      "type": "n8n-nodes-base.mySql",
      "typeVersion": 2.5,
      "position": [
        192,
        224
      ],
      "id": "5a965f17-d9eb-4c15-b613-48a8c30254c1",
      "name": "query tables name",
      "credentials": {
        "mySql": {
          "id": "5Z4JJVd4vFunfa9J",
          "name": "æµ‹è¯•æœåŠ¡å™¨"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
      "typeVersion": 1,
      "position": [
        816,
        784
      ],
      "id": "9674a7a4-a217-4349-adc7-686f56bb0da8",
      "name": "DeepSeek Chat Model",
      "credentials": {
        "deepSeekApi": {
          "id": "dS7qOWJaytHbt6MA",
          "name": "DeepSeek account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Here is the database schema: {{ $json.schema }}\nè¿™æ˜¯ç”¨æˆ·çš„æé—®\n{{ $json.chatinput }}\n\n\næ•°æ®åº“åˆ«åå‘½åè§„èŒƒï¼š\n  - ä½¿ç”¨è¡¨åçš„ç¼©å†™æˆ–é¦–å­—æ¯ä½œä¸ºåˆ«å\n  - é¿å…ä½¿ç”¨SQLä¿ç•™å­—ï¼ˆå¦‚SET, KEY, INDEX, ORDER, GROUPç­‰ï¼‰\n  - æ¨èä½¿ç”¨ï¼šst, sl, pm, sr, se_timeç­‰\n  - è¡¨åç¼©å†™è§„åˆ™ï¼š\n    * product_material â†’ pm\n    * store â†’ s\n    * storeroom â†’ sr  \n    * stock_log â†’ sl\n    * stock_expired_time â†’ se_time æˆ– setime",
        "options": {
          "systemMessage": "\nä¸€ã€è§’è‰²å®šä½\nè§’è‰²ï¼šMySQL DBA ä¸“å®¶\nç®€ä»‹ï¼šä¸€ä½æŠ€è‰ºé«˜è¶…ã€ç»éªŒä¸°å¯Œçš„ MySQL æ•°æ®åº“ç®¡ç†å‘˜ï¼Œä¸“é—¨æ ¹æ®ç”¨æˆ·éœ€æ±‚å’Œæä¾›çš„æ•°æ®ç»“æ„ï¼Œç²¾å¿ƒåˆ¶ä½œç²¾ç¡®é«˜æ•ˆçš„ SQL æŸ¥è¯¢ã€‚\nèƒŒæ™¯ï¼šåœ¨å„ç§ä¸šåŠ¡æ‹¥æœ‰ä¸°å¯Œçš„æ•°æ®è®¾è®¡ã€ä¼˜åŒ–å’Œ MySQL æ•°æ®åº“æŸ¥è¯¢å¼€å‘ç»éªŒã€‚\næ“…é•¿ï¼šåˆ†æéœ€æ±‚ã€ä¸»é¢˜æ¨¡å‹ã€è¯¢é—®ç­›é€‰ã€ç›´æ¥ç†è§£è§£å†³æ–¹ç´¢ï¼Œæ— éœ€ä¸å¿…è¦çš„è§£é‡Šã€‚\nç›®æ ‡å—ä¼—ï¼šéœ€è¦æ ¹æ®æ•°æ®ç»“æ„å’Œæ‰€éœ€ä¿¡æ¯ç”Ÿæˆç‰¹å®š SQL æŸ¥è¯¢çš„ç”¨æˆ·ã€‚\n\näºŒã€æ ¸å¿ƒèƒ½åŠ›\nSQL æŸ¥è¯¢ç”Ÿæˆ\næŸ¥è¯¢åˆæˆï¼šæ„å»ºè¯­æ³•æ­£ç¡®ã€è¯­ä¹‰å‡†ç¡®çš„ SQL æŸ¥è¯¢ã€‚\næ•°æ®ç»“æ„è§£è¯»ï¼šç†è§£å¹¶åˆ©ç”¨æä¾›çš„æ•°æ®åº“ç»“æ„è¿›è¡ŒæŸ¥è¯¢ç”Ÿæˆã€‚\næŸ¥è¯¢ä¼˜åŒ–ï¼šç¼–å†™é«˜æ•ˆæŸ¥è¯¢ä»¥è·å¾—æœ€ä½³æ€§èƒ½ã€‚\nèšåˆä¸åˆ†ç»„ï¼šä½¿ç”¨èšåˆå‡½æ•°å’Œåˆ†ç»„æ¥æ±‡æ€»æ•°æ®ã€‚\n\nMySQL æ•°æ®åº“çŸ¥è¯†\nSchema è®¾è®¡ï¼šç†è§£å¹¶åˆ©ç”¨æ•°æ®åº“ Schema è¿›è¡Œæœ‰æ•ˆæŸ¥è¯¢ã€‚\næ•°æ®ç±»å‹ï¼šè¯†åˆ«å’Œå¤„ç† MySQL ä¸­ä¸åŒæ•°æ®ç±»å‹ã€‚\nç´¢å¼•ï¼šç†è§£ç´¢å¼•å¯¹æŸ¥è¯¢æ€§èƒ½çš„å½±å“ã€‚\nå¸¸ç”¨ SQL å‡½æ•°ï¼šåˆ©ç”¨å†…ç½® SQL å‡½æ•°è¿›è¡Œæ•°æ®æ“ä½œå’Œåˆ†æã€‚\n\né—®é¢˜è§£å†³\néœ€æ±‚åˆ†æï¼šç†è§£ç”¨æˆ·çš„æŸ¥è¯¢éœ€æ±‚ã€‚\né€»è¾‘æ¨ç†ï¼šè¿ç”¨é€»è¾‘æ¨ç†æ¨å¯¼å‡ºæ­£ç¡®çš„ SQL æŸ¥è¯¢ã€‚\næ•°æ®åˆ†æå¸ˆï¼šåˆ©ç”¨æ•°æ®åˆ†ææŠ€æœ¯è¿›è¡Œæœ‰æ•ˆçš„æŸ¥è¯¢è®¾è®¡ã€‚\næ¨¡å¼è¯†åˆ«ï¼šè¯†åˆ«å¸¸è§æŸ¥è¯¢æ¨¡å¼å¹¶å°†å…¶é€‚é…åˆ°ç‰¹å®šåœºæ™¯ã€‚\næ²Ÿé€š\nç®€æ´æ²Ÿé€šï¼šæä¾›ç›´æ¥ä¸”å¯æ‰§è¡Œçš„ SQL ä»£ç ã€‚\néœ€æ±‚æ¾„æ¸…ï¼šåœ¨éœ€è¦æ—¶æå‡ºæ¾„æ¸…é—®é¢˜ä»¥ç”Ÿæˆç›¸å…³æŸ¥è¯¢ã€‚\nç¤ºä¾‹å’Œè§£é‡Šï¼šä»ç”¨æˆ·çš„ç¤ºä¾‹ä¸­å­¦ä¹ ä»¥æ”¹å–„æŸ¥è¯¢ç”Ÿæˆã€‚\n\nä¸‰ã€å·¥ä½œè§„èŒƒä¸æµç¨‹\nç§‰æ‰¿ SQL æ ‡å‡†ï¼šç¡®ä¿ SQL è¯­å¥ç¬¦åˆ MySQL å…¼å®¹çš„æ ‡å‡† SQL è¯­æ³•ã€‚\næ€§èƒ½è€ƒè™‘ï¼šå§‹ç»ˆè€ƒè™‘æŸ¥è¯¢æ€§èƒ½å¹¶åœ¨é€‚å½“æ—¶åº”ç”¨ä¼˜åŒ–ã€‚\n\nè¿­ä»£ä¼˜åŒ–ï¼šå¦‚æœç¬¬ä¸€ä¸ªæŸ¥è¯¢ä¸ç†æƒ³ï¼Œæ ¹æ®åç»­ç”¨æˆ·è¾“å…¥è¿›è¡Œä¼˜åŒ–ã€‚\nçº¦æŸ\nä¸åšå‡è®¾ï¼šä¸è¦å¯¹æ•°æ® Schema åšå‡ºè¶…å‡ºæä¾›çš„å‡è®¾ã€‚\næœ‰é™äº¤äº’ï¼šå°½é‡å‡å°‘ç”¨æˆ·çš„è¯·æ±‚ï¼Œå°½å¯èƒ½æ¨æ–­æ„å›¾ã€‚\nä¸ä½¿ç”¨å¤–éƒ¨èµ„æºï¼šä¸è¦ä½¿ç”¨å¤–éƒ¨èµ„æºæˆ–å·¥å…·æ¥ç”ŸæˆæŸ¥è¯¢ã€‚\næ•°æ®ç²¾ç®€ï¼šç¡®ä¿è¿”å›ä¸å¤šä¸å°‘è¶³å¤Ÿçš„ä¿¡æ¯ï¼Œä¸å«ä¸å¿…è¦åœ°æš´éœ²æ•æ„Ÿä¿¡æ¯ã€‚\n\nå·¥ä½œæµç¨‹\nç›®æ ‡ï¼šæ ¹æ®ç»™å®šæ•°æ®ç»“æ„ï¼Œç”Ÿæˆå‡†ç¡®é«˜æ•ˆåœ°å›ç­”ç”¨æˆ·é—®é¢˜çš„ MySQL æŸ¥è¯¢ã€‚\næ­¥éª¤ 1ï¼šåˆ†æç”¨æˆ·çš„è¯·æ±‚ï¼Œç¡®å®šæ‰€éœ€ç»“æœå’Œæ•°æ®éœ€æ±‚ã€‚\næ­¥éª¤ 2ï¼šæ£€æŸ¥æä¾›çš„æ•°æ®ç»“æ„ï¼Œè¯†åˆ«ç›¸å…³çš„è¡¨ã€åˆ—å’Œå…³ç³»ã€‚\næ­¥éª¤ 3ï¼šæ„å»ºä¸€ä¸ª SQL æŸ¥è¯¢ï¼Œæ ¹æ®éœ€è¦é€‰æ‹©ã€è¿‡æ»¤ã€èšåˆå’Œæ’åºæ•°æ®ã€‚\næ­¥éª¤ 4ï¼šç¡®ä¿ç”Ÿæˆçš„æŸ¥è¯¢éµå¾ª SQL æ ‡å‡†å’Œ MySQL è¯­æ³•ï¼Œå¹¶é’ˆå¯¹æ€§èƒ½è¿›è¡Œä¼˜åŒ–ã€‚\næ­¥éª¤ 5ï¼šç¡®ä¿æ‰€æœ‰çš„æŸ¥è¯¢å’Œè¡¨åŸºäºç°æœ‰è¡¨çš„ç»“æ„æ¥ç”Ÿæˆsqlä¸è¦æ“…è‡ªç¼–é€ è¡¨ç»“æ„å’Œæ•°æ®\n\nå››ã€å¯èƒ½ä¼šè¿ç”¨åˆ°çš„è¡¨å­—æ®µç»“æ„å’Œæè¿°\n1.product_material äº§å“ä¿¡æ¯è¡¨ï¼Œè®°å½•çš„æ˜¯äº§å“çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯å­—æ®µæè¿°ç­‰\n\n2.store åº“å­˜è¡¨ï¼Œè®°å½•çš„æ˜¯ç›®å‰å­˜å‚¨åœ¨åº“æˆ¿çš„äº§å“ä¿¡æ¯ç­‰\n1)positionæ˜¯äº§å“å­˜æ”¾çš„ä½ç½®ï¼Œä¸‹åˆ’çº¿åˆ†å‰²åˆ†åˆ«ä»£è¡¨ç€å­˜æ”¾åœ¨è¡Œåˆ—å±‚\n\n3.storeroom åº“æˆ¿è¡¨ï¼Œè®°å½•ç›®å‰æ‰€æ‹¥æœ‰çš„åº“æˆ¿ä¿¡æ¯\n\n4.stock_log äº§å“å‡ºå…¥åº“æ—¥å¿—è¡¨ï¼Œè®°å½•çš„æ˜¯æ‰€æœ‰äº§å“å…¥åº“å’Œå‡ºåº“çš„ä¿¡æ¯\n1)statuså­—æ®µä»£è¡¨çš„æ˜¯å‡ºå…¥åº“æ–¹å‘\n2)product_material_idæ˜¯äº§å“çš„idï¼Œå¦‚æœéœ€è¦è·å–äº§å“è¯¦ç»†ä¿¡æ¯éœ€è¦å’Œproduct_materialè¡¨è”è¡¨æŸ¥è¯¢\n3)nameæ˜¯äº§å“çš„åç§°\n4)typeå­—æ®µæ˜¯äº§å“ç±»å‹ï¼Œäº§å“ç±»å‹ï¼ˆ0.disabled1.å‰¯äº§å“2.äºŒç»´ç äº§å“3.äºŒåˆ†ä½“æ´»ç‰›4.ç®±5.å››åˆ†ä½“,6éƒ¨ä½è‚‰7.snç 8æ²¡æœ‰äºŒç»´ç çš„æˆå“ï¼ˆç‰©æ–™ç­‰ï¼‰9å…¶ä»–10æ´»ç‰› 11æ ‡é‡ï¼‰\nå…¶ä¸­å¦‚æœtypeæ˜¯2ä»£è¡¨äºŒç»´ç äº§å“å¦‚æœæ˜¯8ä»£è¡¨æ²¡æœ‰äºŒç»´ç çš„äº§å“\n5)common_idä»£è¡¨äº§å“çš„äºŒç»´ç æˆ–è€…å”¯ä¸€ç \n6ï¼‰storeroom_idä»£è¡¨çš„æ˜¯åº“æˆ¿idéœ€è¦å’Œstoreroomè¡¨è”è¡¨æŸ¥è¯¢è·å–åº“æˆ¿åç§°\n7ï¼‰primary_numæ˜¯äº§å“å…¥åº“æˆ–è€…å‡ºåº“çš„é‡é‡\n8ï¼‰primary_unitæ˜¯äº§å“å…¥åº“å‡ºåº“çš„é‡é‡å•ä½\n9ï¼‰lost_numæ˜¯äº§å“å‡ºåº“çš„æ—¶å€™çš„æŸè€—é‡é‡ï¼Œä¸€èˆ¬ç”¨äºtype=3çš„äº§å“\n\n5.stock_expired_timeäº§å“çš„è¿‡æœŸæ—¶é—´æˆ–è€…é¢„è­¦æ—¶é—´\n1ï¼‰common_idäº§å“é€šç”¨idï¼Œé€šå¸¸æ˜¯äºŒç»´ç äº§å“ä½¿ç”¨ï¼Œå’Œstoreè¡¨å…³è”\n2ï¼‰expired_timeäº§å“çš„è¿‡æœŸæ—¶é—´\n3ï¼‰notice_max_time äº§å“çš„è¿‡æœŸé¢„è­¦æ—¶é—´\n\nå››ã€å…¸å‹æŸ¥è¯¢åœºæ™¯ç¤ºä¾‹\n\nç”¨æˆ·ï¼šæŸ¥è¯¢ç›®å‰åº“æˆ¿çš„å­˜è´§æƒ…å†µ\nå›ç­”ï¼š\nSELECT\ns.name,sr.storeroom_name,s.primary_num,s.primary_unit,s.type\nfrom store as s\nleft join storeroom as sr on sr.id = s.storeroom_id;\n\nç”¨æˆ·ï¼šæŸ¥è¯¢æœ€è¿‘ä¸€ä¸ªæœˆäº§å“å…¥åº“å‡ºåº“çš„æƒ…å†µï¼ˆæŒ‰äº§å“ç»Ÿè®¡å‡ºå…¥åº“æ€»é‡ï¼‰\nå›ç­”ï¼šSELECT \n    product_material_id,\n    name AS äº§å“åç§°,\n    type AS äº§å“ç±»å‹,\n    detail_type AS è¯¦ç»†ç±»å‹,\n    SUM(CASE WHEN status = 1 THEN primary_num ELSE 0 END) AS æ€»å…¥åº“æ•°é‡,\n    SUM(CASE WHEN status = 2 THEN primary_num ELSE 0 END) AS æ€»å‡ºåº“æ•°é‡,\n    COUNT(CASE WHEN status = 1 THEN 1 END) AS å…¥åº“è®°å½•æ•°,\n    COUNT(CASE WHEN status = 2 THEN 1 END) AS å‡ºåº“è®°å½•æ•°\nFROM stock_log\nWHERE create_time >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH)\n    AND create_time < CURDATE() + INTERVAL 1 DAY\nGROUP BY product_material_id, name, type, detail_type\nORDER BY æ€»å…¥åº“æ•°é‡ DESC, æ€»å‡ºåº“æ•°é‡ DESC;\n\nç”¨æˆ·ï¼šæŸ¥æ‰¾å•ä¸€çš„æŸä¸ªäº§å“å­˜æ”¾çš„ä½ç½®\næ€è·¯: è”è¡¨product_materialå’Œstoreè¿˜æœ‰storeroomè¡¨ç„¶åè·å–åˆ°äº§å“çš„positionä½ç½®\n\nç”¨æˆ·ï¼šæŸ¥è¯¢å“ªäº›äº§å“å·²ç»è¿‡æœŸ\nå›ç­”ï¼š\nselect\ns.name,st.expired_time,st.notice_max_time,sr.storeroom_name\nfrom store as s\nleft join stock_expired_time as st on s.common_id = st.common_id\nleft join storeroom as sr on sr.id = s.storeroom_id \nwhere \nst.expired_time > NOW();ã€\n\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        864,
        560
      ],
      "id": "d6b21d98-2ac3-4978-863a-47922102e438",
      "name": "natural language to sql"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "{{ ($json.output.match(/SELECT[\\s\\S]*?;/i) || [])[0] || \"\" }}",
        "options": {}
      },
      "type": "n8n-nodes-base.mySql",
      "typeVersion": 2.5,
      "position": [
        1216,
        560
      ],
      "id": "3ea2a8fe-4aac-4741-8dff-ddf5c8ef4518",
      "name": "sql query",
      "alwaysOutputData": false,
      "credentials": {
        "mySql": {
          "id": "5Z4JJVd4vFunfa9J",
          "name": "æµ‹è¯•æœåŠ¡å™¨"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('sql query').all() }}",
        "options": {
          "systemMessage": "=ä¸€ã€è§’è‰²å®šä½\nä½œä¸º MySQL å†…å®¹æ€»ç»“æ”¥å†™è€…ï¼Œæ ¸å¿ƒèŒèƒ½æ˜¯å°† MySQL æŠ€æœ¯ä¿¡æ¯è½¬åŒ–ä¸ºé€šä¿—æ˜“æ‡‚çš„è‡ªç„¶è¯­è¨€ï¼Œå…·å¤‡æ•°æ®åº“ä¸è‡ªç„¶è¯­è¨€å¤„ç†åŒé‡ä¸“ä¸šçŸ¥è¯†ã€‚ç›®æ ‡å—ä¼—æ˜¯ä» DBA åˆ°å­¦ç”Ÿçš„å¹¿æ³›ç¾¤ä½“ï¼Œä»¥å®¢è§‚ã€ç®€æ´çš„é£æ ¼ä¼ é€’å…³é”®æ¦‚å¿µï¼Œé¿å…æŠ€æœ¯å£å’ã€‚\n\näºŒã€æ ¸å¿ƒæŠ€èƒ½\næ•°æ®å¯è§†åŒ–ï¼šä» MySQL æ–‡æ¡£ã€ä»£ç ç¤ºä¾‹å’ŒæŸ¥è¯¢ä¸­æå–ç›¸å…³æ•°æ®ã€‚\næ¦‚å¿µè¯†åˆ«ï¼šè¯†åˆ«æ‰€æä¾›å†…å®¹ä¸­çš„å…³é”®æ¦‚å¿µã€ç‰¹æ€§å’ŒåŠŸèƒ½ã€‚\næŠ€æœ¯åˆ†æï¼šåˆ†æ MySQL ä¸åŒæ–¹é¢çš„æŠ€æœ¯ç»†èŠ‚å’Œå…³ç³»ã€‚\nå‡†ç¡®æ€§éªŒè¯ï¼šç¡®ä¿æ‘˜è¦ä¿¡æ¯çš„å‡†ç¡®æ€§ï¼Œä»¥ä¿æŒæ‘˜è¦çš„å®Œæ•´æ€§ã€‚\nè‡ªç„¶è¯­è¨€è½¬æ¢\né‡Šä¹‰ï¼šå°†æŠ€æœ¯æœ¯è¯­å’Œæ¦‚å¿µå¥å­æ”¹å†™æˆé€šä¿—æ˜“æ‡‚çš„è¯­è¨€ã€‚\nç®€åŒ–ï¼šç®€åŒ–å¤æ‚çš„æ¦‚å¿µå’Œå¥å­ï¼Œä»¥ä¾¿æ›´å¹¿æ³›åœ°ç†è§£ã€‚\nç»¼åˆï¼šé«˜æ•ˆæ€»ç»“ä¿¡æ¯ï¼ŒåŒæ—¶ä¿ç•™å…³é”®ç»†èŠ‚ã€‚\næ¸…æ™°ï¼šç¡®ä¿è¾“å‡ºæ¸…æ™°ã€è¿è´¯ä¸”æ˜“äºç†è§£ã€‚\n\nä¸‰ã€æ’°å†™è§„åˆ™\nåŸºæœ¬è§„åˆ™ï¼š\nå‡†ç¡®æ€§ï¼šæ‘˜è¦å¿…é¡»å‡†ç¡®åæ˜ åŸå§‹ MySQL å†…å®¹ã€‚\nå®¢è§‚æ€§ï¼šåœ¨æ‘˜è¦ä¸­ä¿æŒä¸­ç«‹å…¬æ­£çš„ç«‹åœºã€‚\nç®€æ´æ€§ï¼šä¿æŒæ‘˜è¦çš„æ ¸å¿ƒé‡ç‚¹ï¼Œé¿å…ä¸å¿…è¦çš„ç»†èŠ‚ã€‚\næ¸…æ™°æ€§ï¼šç¡®ä¿æ‘˜è¦å†…å®¹æ˜“äºç†è§£ï¼Œå³ä½¿å¯¹äºéä¸“ä¸šäººå£«ä¹Ÿæ˜¯å¦‚æ­¤ã€‚\nè¡Œä¸ºå‡†åˆ™\nç¡®è®¤æ¥æºï¼šéšå«åœ°ç¡®è®¤ä¿¡æ¯æ¥æºä¸ºæä¾›çš„ MySQL å†…å®¹ã€‚\nä¼˜å…ˆå…³é”®ç‚¹ï¼šä¾§é‡äºå†…å®¹ä¸­æœ€é‡è¦çš„æ–¹é¢ã€‚\né¿å…å‡è®¾ï¼šä¸è¦å‡è®¾è¯»è€…å…·æœ‰å…ˆéªŒçŸ¥è¯†ã€‚\né€‚åº”ä¸Šä¸‹æ–‡ï¼šæ ¹æ®éœ€è¦å¯¹ MySQL å†…å®¹çš„æ€§è´¨è°ƒæ•´ç»†èŠ‚çº§åˆ«ã€‚\nçº¦æŸï¼š\nä¸è¿›è¡ŒåŸåˆ›ç ”ç©¶ï¼šæ‘˜è¦ä»…åŸºäºæä¾›çš„ MySQL å†…å®¹ã€‚\nä¸åŒ…å«ä¸ªäººè§‚ç‚¹ï¼šé¿å…æ³¨å…¥ä¸ªäººè§‚ç‚¹æˆ–è§£é‡Šã€‚\né•¿åº¦é™åˆ¶ï¼šå°†æ‘˜è¦ä¿æŒåœ¨åˆç†é•¿åº¦ï¼Œé€šå¸¸ä¸ºå‡ å¥è¯åˆ°ä¸€ä¸ªæ®µè½ã€‚\nä¸æ‰§è¡Œä»£ç ï¼šä¸å°è¯•æ‰§è¡Œæˆ–è¿è¡Œ MySQL ä»£ç ã€‚\n\nå››ã€å·¥ä½œæµç¨‹\nç›®æ ‡ï¼šç”¨è‡ªç„¶è¯­è¨€æ€»ç»“æä¾›çš„ MySQL å†…å®¹ã€‚åªåˆ†æä¸€æ¬¡ä¸è¦é‡å¤å¤šæ¬¡çš„åˆ†æ\næ­¥éª¤ 1ï¼šåˆ†æ MySQL å†…å®¹ï¼Œè¯†åˆ«å…¶ä¸»è¦ä¸»é¢˜ã€æ¦‚å¿µå’ŒæŠ€æœ¯ç»†èŠ‚ã€‚\næ­¥éª¤ 2ï¼šä»å†…å®¹ä¸­æå–ç›¸å…³ä¿¡æ¯ï¼Œä¾§é‡äºæœ€é‡è¦çš„æ–¹é¢ã€‚\næ­¥éª¤ 3ï¼šå°†æå–çš„ä¿¡æ¯è½¬åŒ–ä¸ºè‡ªç„¶è¯­è¨€ï¼Œè¯­è¨€è¦ç®€æ´ã€æ˜“äºå¤§ä¼—ç†è§£ã€‚\næ­¥éª¤ 4ï¼šå¦‚æœç”¨æˆ·æ˜ç¡®è¦æ±‚ç”Ÿæˆå›¾è¡¨ï¼Œåˆ™è°ƒç”¨å·¥å…·ç”Ÿæˆå¯è§†åŒ–å›¾è¡¨ï¼Œå¦åˆ™ä¸éœ€è¦ï¼Œå¦‚æœç”¨æˆ·æ˜ç¡®è¦æ±‚ï¼Œéœ€è¦ç”Ÿæˆå›¾è¡¨ã€‚è¯·å°†æ•°æ®è½¬æ¢ä¸ºç¬¦åˆ QuickChart æˆ– Chart.js çš„ JSON æ ¼å¼ã€‚\n    è¯·ç¡®ä¿ç”Ÿæˆçš„ JSON åˆæ³•ï¼Œå¹¶ä¸”èƒ½å¤Ÿç›´æ¥ç”¨åœ¨ Chart.js ä¸­å»ç”Ÿæˆå›¾è¡¨ã€‚\n    ä¸è¦åŒ…å«ä»»ä½•å¤šä½™çš„å†…å®¹ï¼Œä»¥ä¾¿å¯ç›´æ¥ç”¨äº QuickChart çš„ URL è¯·æ±‚ã€‚\nç¡®ä¿ç»“æœä¸€ä¸ªç®€æ´ã€æ¸…æ™°ã€å‡†ç¡®çš„ MySQL å†…å®¹æ‘˜è¦ã€‚\n\nå››ã€æ‰§è¡Œè§„èŒƒ\nä½œä¸ºMysqlæ‘˜è¦å™¨ï¼Œå¿…é¡»éµå®ˆä¸Šè¯‰è§„åˆ™å¹¶æ ¹æ®å·¥ä½œæµç¨‹æ‰§è¡Œä»»åŠ¡\n\nå®¢æˆ·çš„æé—®å¦‚ä¸‹\n{{ $('Chat Trigger').item.json.chatInput }}\næ ¹æ®å®¢æˆ·çš„é—®é¢˜å’Œéœ€æ±‚,ç»“åˆæ•°æ®åº“çš„æ•°æ®å¹¶å¯¹åŸå§‹æ•°æ®è¿›è¡Œæ€»ç»“å’Œåˆ†æç»™å‡ºç­”æ¡ˆã€\næœ€åçš„ç»“æœè¯·è½¬åŒ–æˆmarkdownæ ¼å¼\nmarkdownçš„æ ¼å¼è¦æ±‚å¦‚ä¸‹\næ ‡é¢˜\n# ä¸€çº§æ ‡é¢˜\n## äºŒçº§æ ‡é¢˜\n### ä¸‰çº§æ ‡é¢˜\n#### å››çº§æ ‡é¢˜\n##### äº”çº§æ ‡é¢˜\n###### å…­çº§æ ‡é¢˜\n\nå¼•ç”¨\n> A man who stands for nothing will fall for anything.\n\næ–‡å­—åŠ ç²—ã€æ–œä½“\n**bold**\n*italic*\n\né“¾æ¥\n[this is a link](http://name.com)\n\nå›¾ç‰‡ï¼ˆå»ºè®®ä¸è¦è¶…è¿‡20å¼ ï¼‰\n![](http://name.com/pic.jpg)\n\næ— åºåˆ—è¡¨\n- item1\n- item2\n\næœ‰åºåˆ—è¡¨\n1. item1\n2. item2"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        1440,
        560
      ],
      "id": "3602447b-8d72-4204-a9fb-7a269c5152e0",
      "name": "sql to natural language",
      "executeOnce": true
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
      "typeVersion": 1,
      "position": [
        1392,
        784
      ],
      "id": "25cf0824-1803-48f2-9de9-3561052f2476",
      "name": "è‡ªç„¶è¯­è¨€chat",
      "credentials": {
        "deepSeekApi": {
          "id": "dS7qOWJaytHbt6MA",
          "name": "DeepSeek account"
        }
      }
    },
    {
      "parameters": {
        "content": "## åªéœ€è¿è¡Œæ­¤éƒ¨åˆ†ä¸€æ¬¡ \n\n* ä»æ‰˜ç®¡äºæœ¬åœ° PostgreSQL çš„æ•°æ®åº“ä¸­åŠ è½½æ‰€æœ‰è¡¨çš„åˆ—è¡¨\n* æå–æ¯ä¸ªè¡¨çš„æ•°æ®åº“ç»“æ„å¹¶æ·»åŠ è¡¨å\n* å°†ç»“æ„è½¬æ¢ä¸ºäºŒè¿›åˆ¶ JSON æ ¼å¼\n* å°†ç»“æ„ä¿å­˜åˆ°æœ¬åœ°çš„ `./sales_postgresql.json` æ–‡ä»¶ä¸­\n\n***ç°åœ¨ä½ å¯ä»¥ä½¿ç”¨èŠå¤©æ¥â€œå¯¹â€ä½ çš„æ•°æ®è¯´è¯å•¦ï¼*** ğŸ‰\n",
        "height": 466,
        "width": 1385,
        "color": 3
      },
      "id": "1da4aa08-dead-433d-b2d2-4e7729349bec",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -64,
        -80
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "public": true,
        "initialMessages": "ä½ å¥½ï¼Œæˆ‘æ˜¯æ™ºèƒ½ä»“åº“å®¢æœï¼Œæœ‰ä»€ä¹ˆå¯èƒ½å¸®åŠ©æ‚¨çš„ï¼Ÿ",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.4,
      "position": [
        -32,
        560
      ],
      "id": "27198acd-a6e0-4743-8267-1abc05b3bc75",
      "name": "Chat Trigger",
      "webhookId": "22043b71-4c36-4391-9d8e-32787c2a7e0a"
    },
    {
      "parameters": {
        "jsCode": "// è·å–å‰ä¸€æ­¥AI AgentèŠ‚ç‚¹çš„è¾“å‡ºæ•°æ®\nconst aiOutput = $input.first().json;\n\n// æå–å¹¶æ¸…ç†markdownå†…å®¹\nlet markdownContent = aiOutput.output;\nif (markdownContent.includes('```markdown')) {\n  markdownContent = markdownContent.replace(/```markdown\\s*/, '').replace(/\\s*```$/, '');\n}\n\n// æ„å»ºä¼ä¸šå¾®ä¿¡ã€Œç¾¤èŠæœºå™¨äººã€æ‰€éœ€çš„JSONæ ¼å¼\nconst botMessage = {\n  \"msgtype\": \"markdown\", // æ¶ˆæ¯ç±»å‹\n  \"markdown\": {\n    \"content\": markdownContent // æ¸…ç†åçš„markdownå†…å®¹\n  }\n};\n\n// è¾“å‡ºç»™HTTP RequestèŠ‚ç‚¹\nreturn botMessage;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1792,
        560
      ],
      "id": "7f2dccfa-7344-4a27-8cca-a3fd9df71cbc",
      "name": "covert msg to markdown"
    },
    {
      "parameters": {
        "content": "## ç”Ÿæˆå¯è§†åŒ–å›¾è¡¨\n\n- æŸ±çŠ¶å›¾ã€é¥¼å›¾ã€è¶‹åŠ¿å›¾ç­‰",
        "height": 620,
        "width": 1288,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -240,
        1152
      ],
      "typeVersion": 1,
      "id": "6a53259b-c96a-469b-ac72-ab7267266108",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "inputSource": "passthrough"
      },
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "typeVersion": 1.1,
      "position": [
        -208,
        1344
      ],
      "id": "cef9182a-3908-48ce-9fc3-d83850d0e6f6",
      "name": "When Executed by Another Workflow"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=input data: {{ $json.query }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "### è§’è‰²è®¾å®š\n\nä½ æ˜¯ä¸€ä½ Chart.js å¯è§†åŒ–ä¸“å®¶ã€‚ä½ çš„ä¸»è¦ä»»åŠ¡æ˜¯æ ¹æ®ç”¨æˆ·çš„è¯·æ±‚ï¼Œç”Ÿæˆ**æœ‰æ•ˆã€ç»“æ„æ¸…æ™°ã€æ ‡ç­¾æ˜ç¡®**çš„ Chart.js é…ç½®å¯¹è±¡ã€‚è¿™äº›é…ç½®åº”å½“å¯ä»¥ç›´æ¥ç”¨äº Chart.js çš„æ„é€ å‡½æ•° `new Chart()` ä¸­ã€‚\n\n---\n\n### è¾“å…¥è¦æ±‚\n\nä½ å°†æ¥æ”¶åˆ°ç”¨æˆ·å…³äºå›¾è¡¨çš„æè¿°ï¼Œè¯·æ ¹æ®ä»¥ä¸‹è¦ç´ è§£æå’Œå“åº”ï¼š\n\n#### 1. å›¾è¡¨ç±»å‹\n\nç”¨æˆ·å¯èƒ½ä¼šæŒ‡å®šå›¾è¡¨ç±»å‹ï¼Œå¦‚ï¼š`bar`ï¼ˆæŸ±çŠ¶å›¾ï¼‰ã€`line`ï¼ˆæŠ˜çº¿å›¾ï¼‰ã€`pie`ï¼ˆé¥¼å›¾ï¼‰ã€`scatter`ï¼ˆæ•£ç‚¹å›¾ï¼‰ã€`radar`ã€`bubble` ç­‰ã€‚\n\n#### 2. æ•°æ®\n\nç”¨æˆ·æä¾›çš„æ•°æ®å¯èƒ½ä¸º CSVã€JSONã€åˆ—è¡¨æˆ–è‡ªç„¶è¯­è¨€å½¢å¼ã€‚\n\n* å¯¹æ ¼å¼ä¸æ¸…æ™°çš„æ•°æ®ï¼Œè¦ä¸»åŠ¨æé—®æ¾„æ¸…ã€‚\n* å¦‚æœ‰éœ€è¦ï¼Œå¯æå–å’Œè½¬æ¢æ•°æ®ç»“æ„ã€‚\n\n#### 3. æ ‡ç­¾ä¿¡æ¯\n\nç”¨æˆ·åº”æä¾›ç”¨äºåæ ‡è½´ã€æ•°æ®ç‚¹ç­‰å…ƒç´ çš„æ ‡ç­¾ï¼Œç‰¹åˆ«æ˜¯ï¼š\n\n* **è½´æ ‡é¢˜**ï¼ˆå¦‚ï¼š\"æœˆä»½\", \"é”€å”®é¢ï¼ˆUSDï¼‰\"ï¼‰\n* **å•ä½**ï¼ˆå¦‚ï¼š\"(kg)\", \"(USD)\"ï¼‰\n* **æ•°æ®ç±»å‹**ï¼ˆåˆ†ç±»ã€æ•°å€¼å‹ã€æ—¶é—´åºåˆ—ï¼‰\n  å¦‚ä¿¡æ¯ç¼ºå¤±ï¼Œè¯·ä¸»åŠ¨å‘ç”¨æˆ·ç¡®è®¤ã€‚\n\n#### 4. æ ·å¼è‡ªå®šä¹‰ï¼ˆStylingï¼‰\n\næ”¯æŒé¢œè‰²ã€å­—ä½“ã€ç½‘æ ¼çº¿ã€æ ‡é¢˜ã€å›¾ä¾‹ã€å·¥å…·æç¤ºã€åæ ‡è½´åˆ»åº¦ç­‰æ ·å¼è°ƒæ•´ã€‚\n\n* è‹¥ç”¨æˆ·æœªæä¾›å…·ä½“æ ·å¼ï¼Œä½¿ç”¨ Chart.js é»˜è®¤å€¼ã€‚\n\n#### 5. Chart.js ç‰¹å®šåŠŸèƒ½\n\næ ¹æ®ç”¨æˆ·è¯·æ±‚ï¼Œæ”¯æŒä½¿ç”¨é«˜çº§åŠŸèƒ½ï¼Œå¦‚ï¼šå¯¹æ•°åæ ‡ã€åŠ¨ç”»ã€æ’ä»¶ç­‰ã€‚\n\n#### 6. è‡ªç„¶è¯­è¨€è¾“å…¥è§£æ\n\næ”¯æŒå°†ä¸ç»“æ„åŒ–çš„æè¿°ï¼Œå‡†ç¡®è½¬æ¢ä¸ºæœ‰æ•ˆçš„ Chart.js é…ç½®ã€‚\n\n---\n\n### è¾“å‡ºè¦æ±‚\n\nè¾“å‡ºä¸€ä¸ª**æœ‰æ•ˆã€æ ¼å¼è§„èŒƒã€å¯è¯»æ€§å¼º**çš„ Chart.js JSON é…ç½®å¯¹è±¡ï¼Œå¿…é¡»åŒ…æ‹¬ï¼š\n\n* æ•°æ®éƒ¨åˆ†ï¼ˆ`data`ï¼‰\n* é…ç½®é¡¹ï¼ˆ`options`ï¼‰\n* æ¸…æ™°çš„ x è½´å’Œ y è½´æ ‡ç­¾ï¼ˆ`options.scales` ä¸­ï¼‰\n* å¿…è¦æ—¶æ·»åŠ å•ä½ã€æ ‡é¢˜ã€æ•°æ®æ ¼å¼ï¼ˆå¦‚è´§å¸ã€æ—¥æœŸç­‰ï¼‰\n\n---\n\n### ç¤ºä¾‹è¾“å…¥ï¼ˆä¼˜åŒ–ç‰ˆï¼‰\n\n> åˆ›å»ºä¸€ä¸ªæŸ±çŠ¶å›¾ï¼Œå±•ç¤º 2024 å¹´ç¬¬ä¸€å­£åº¦æ¯æœˆé”€å”®é¢ï¼š1 æœˆä¸º 10,000 ç¾å…ƒï¼Œ2 æœˆä¸º 12,000 ç¾å…ƒï¼Œ3 æœˆä¸º 15,000 ç¾å…ƒã€‚æŸ±å­é¢œè‰²ä¸ºè“è‰²ã€‚å›¾è¡¨æ ‡é¢˜ä¸º \"Q1 2024 é”€å”®é¢\"ã€‚x è½´ä¸º \"æœˆä»½\"ï¼Œy è½´ä¸º \"é”€å”®é¢ï¼ˆUSDï¼‰\"ã€‚\n\n### ç¤ºä¾‹è¾“å‡º\n\nè¯·ç”Ÿæˆç¬¦åˆæœ€æ–° Chart.js ç‰ˆæœ¬æ ‡å‡†çš„ JSON é…ç½®ï¼Œè¾“å‡ºç±»ä¼¼ï¼š\n\n```json\n{\n  \"type\": \"bar\",\n  \"data\": {\n    \"labels\": [\"January\", \"February\", \"March\"],\n    \"datasets\": [{\n      \"label\": \"é”€å”®é¢\",\n      \"data\": [10000, 12000, 15000],\n      \"backgroundColor\": \"blue\"\n    }]\n  },\n  \"options\": {\n    \"responsive\": true,\n    \"plugins\": {\n      \"title\": {\n        \"display\": true,\n        \"text\": \"Q1 2024 é”€å”®é¢\"\n      }\n    },\n    \"scales\": {\n      \"x\": {\n        \"title\": {\n          \"display\": true,\n          \"text\": \"æœˆä»½\"\n        }\n      },\n      \"y\": {\n        \"title\": {\n          \"display\": true,\n          \"text\": \"é”€å”®é¢ï¼ˆUSDï¼‰\"\n        }\n      }\n    }\n  }\n}\n```\n\n---\n\n### é‡è¦æ³¨æ„äº‹é¡¹\n\n* **æ•°æ®éªŒè¯**ï¼šå¦‚æ•°æ®ä¸å®Œæ•´æˆ–å­˜åœ¨æ­§ä¹‰ï¼ŒåŠ¡å¿…æç¤ºç”¨æˆ·å¹¶è¯·æ±‚è¡¥å……ä¿¡æ¯ã€‚\n* **é”™è¯¯å¤„ç†**ï¼šé‡åˆ°æ— æ³•ç”Ÿæˆå›¾è¡¨çš„æƒ…å†µï¼Œåº”æ˜ç¡®å‘ŠçŸ¥ç”¨æˆ·åŸå› ã€‚\n* **Chart.js ç‰ˆæœ¬**ï¼šé»˜è®¤ä½¿ç”¨æœ€æ–°ç‰ˆ Chart.jsï¼Œé™¤éç”¨æˆ·å¦è¡ŒæŒ‡å®šã€‚\n* **æœ€ä½³å®è·µ**ï¼šéµå¾ª Chart.js å®˜æ–¹æ¨èçš„é…ç½®æ–¹å¼ï¼Œç¡®ä¿å›¾è¡¨æ¸…æ™°ã€æ˜“è¯»ã€ä¸“ä¸šã€‚\n* **é‡ç‚¹å¼ºè°ƒ**ï¼šæ‰€æœ‰è¾“å‡ºå¿…é¡»å…·å¤‡æ¸…æ™°çš„åæ ‡è½´æ ‡é¢˜å’Œå•ä½ï¼Œä½“ç°å›¾è¡¨çš„ä¸“ä¸šæ€§å’Œå¯è¯»æ€§ã€‚\n\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        144,
        1360
      ],
      "id": "e26e204a-c58d-47f3-a27b-02d60bc72080",
      "name": "AI Agent Chart Generator"
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"name\": \"chart_configuration\",\n  \"description\": \"Configuration schema for Chart.js charts\",\n  \"strict\": true,\n  \"schema\": {\n    \"type\": \"object\",\n    \"properties\": {\n      \"type\": {\n        \"type\": \"string\",\n        \"enum\": [\"bar\", \"line\", \"radar\", \"pie\", \"doughnut\", \"polarArea\", \"bubble\", \"scatter\", \"area\"]\n      },\n      \"data\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"labels\": {\n            \"type\": \"array\",\n            \"items\": {\n              \"type\": \"string\"\n            }\n          },\n          \"datasets\": {\n            \"type\": \"array\",\n            \"items\": {\n              \"type\": \"object\",\n              \"properties\": {\n                \"label\": {\n                  \"type\": [\"string\", \"null\"]\n                },\n                \"data\": {\n                  \"type\": \"array\",\n                  \"items\": {\n                    \"type\": \"number\"\n                  }\n                },\n                \"backgroundColor\": {\n                  \"type\": [\"array\", \"null\"],\n                  \"items\": {\n                    \"type\": \"string\"\n                  }\n                },\n                \"borderColor\": {\n                  \"type\": [\"array\", \"null\"],\n                  \"items\": {\n                    \"type\": \"string\"\n                  }\n                },\n                \"borderWidth\": {\n                  \"type\": [\"number\", \"null\"]\n                }\n              },\n              \"required\": [\"data\", \"label\", \"backgroundColor\", \"borderColor\", \"borderWidth\"],\n              \"additionalProperties\": false\n            }\n          }\n        },\n        \"required\": [\"labels\", \"datasets\"],\n        \"additionalProperties\": false\n      },\n      \"options\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"scales\": {\n            \"type\": [\"object\", \"null\"],\n            \"properties\": {\n              \"yAxes\": {\n                \"type\": \"array\",\n                \"items\": {\n                  \"type\": [\"object\", \"null\"],\n                  \"properties\": {\n                    \"ticks\": {\n                      \"type\": [\"object\", \"null\"],\n                      \"properties\": {\n                        \"max\": {\n                          \"type\": [\"number\", \"null\"]\n                        },\n                        \"min\": {\n                          \"type\": [\"number\", \"null\"]\n                        },\n                        \"stepSize\": {\n                          \"type\": [\"number\", \"null\"]\n                        },\n                        \"beginAtZero\": {\n                          \"type\": [\"boolean\", \"null\"]\n                        }\n                      },\n                      \"required\": [\"max\", \"min\", \"stepSize\", \"beginAtZero\"],\n                      \"additionalProperties\": false\n                    },\n                    \"scaleLabel\": {\n                      \"type\": [\"object\", \"null\"],\n                      \"properties\": {\n                        \"display\": {\n                          \"type\": [\"boolean\", \"null\"]\n                        },\n                        \"labelString\": {\n                          \"type\": [\"string\", \"null\"]\n                        }\n                      },\n                      \"additionalProperties\": false\n                    }\n                  },\n                  \"required\": [\"ticks\"],\n                  \"additionalProperties\": false\n                }\n              },\n              \"xAxes\": {\n                \"type\": \"array\",\n                \"items\": {\n                  \"type\": [\"object\", \"null\"],\n                  \"properties\": {\n                    \"stacked\": {\n                      \"type\": [\"boolean\", \"null\"]\n                    },\n                    \"scaleLabel\": {\n                      \"type\": [\"object\", \"null\"],\n                      \"properties\": {\n                        \"display\": {\n                          \"type\": [\"boolean\", \"null\"]\n                        },\n                        \"labelString\": {\n                          \"type\": [\"string\", \"null\"]\n                        }\n                      },\n                      \"additionalProperties\": false\n                    }\n                  },\n                  \"required\": [\"stacked\"],\n                  \"additionalProperties\": false\n                }\n              }\n            },\n            \"required\": [\"yAxes\", \"xAxes\"],\n            \"additionalProperties\": false\n          },\n          \"plugins\": {\n            \"type\": [\"object\", \"null\"],\n            \"properties\": {\n              \"title\": {\n                \"type\": [\"object\", \"null\"],\n                \"properties\": {\n                  \"display\": {\n                    \"type\": [\"boolean\", \"null\"]\n                  },\n                  \"text\": {\n                    \"type\": [\"string\", \"null\"]\n                  }\n                },\n                \"required\": [\"display\", \"text\"],\n                \"additionalProperties\": false\n              },\n              \"legend\": {\n                \"type\": [\"object\", \"null\"],\n                \"properties\": {\n                  \"display\": {\n                    \"type\": [\"boolean\", \"null\"]\n                  },\n                  \"position\": {\n                    \"type\": [\"string\", \"null\"],\n                    \"enum\": [\"top\", \"left\", \"bottom\", \"right\", null]\n                  }\n                },\n                \"required\": [\"display\", \"position\"],\n                \"additionalProperties\": false\n              }\n            },\n            \"required\": [\"title\", \"legend\"],\n            \"additionalProperties\": false\n          },\n          \"responsive\": {\n            \"type\": [\"boolean\", \"null\"]\n          },\n          \"maintainAspectRatio\": {\n            \"type\": [\"boolean\", \"null\"]\n          },\n          \"animation\": {\n            \"type\": [\"object\", \"null\"],\n            \"properties\": {\n              \"duration\": {\n                \"type\": [\"number\", \"null\"]\n              },\n              \"easing\": {\n                \"type\": [\"string\", \"null\"]\n              }\n            },\n            \"additionalProperties\": false\n          }\n        },\n        \"required\": [\"scales\", \"plugins\"],\n        \"additionalProperties\": false\n      }\n    },\n    \"required\": [\"type\", \"data\", \"options\"],\n    \"additionalProperties\": false\n  }\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        352,
        1584
      ],
      "id": "3111b6d1-6b2c-4d80-86e6-997f54aae5bd",
      "name": "Structured Output Parser"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
      "typeVersion": 1,
      "position": [
        96,
        1584
      ],
      "id": "66463d5c-6cd0-42c3-9dbf-87b51c2a4473",
      "name": "DeepSeek change chartjs",
      "credentials": {
        "deepSeekApi": {
          "id": "dS7qOWJaytHbt6MA",
          "name": "DeepSeek account"
        }
      }
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "{\n  \"chartUrl\": \"https://quickchart.io/chart?width=800&height=400&c=\" + encodeURIComponent(JSON.stringify($json.output))\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        544,
        1360
      ],
      "id": "4221b7f0-ea5f-4711-a2bc-f55648af62d2",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "description": "=å¦‚éœ€ç”Ÿæˆå›¾è¡¨ï¼Œè¯·è°ƒç”¨ç›¸åº”å·¥å…·ã€‚åŠ¡å¿…æ­£ç¡®è½¬ä¹‰æ‰€æœ‰å­—ç¬¦ä¸²ï¼Œå°¤å…¶æ˜¯å¤šè¡Œå†…å®¹ã€‚è¾“å‡ºå›¾è¡¨æ—¶ï¼Œä½¿ç”¨ Markdown æ ¼å¼åµŒå…¥å›¾åƒé“¾æ¥ï¼Œä»¥å®ç°å›¾è¡¨çš„å†…è”å±•ç¤ºã€‚\n\næ ¼å¼ç¤ºä¾‹ï¼š![å›¾è¡¨](å›¾è¡¨URL)",
        "workflowId": {
          "__rl": true,
          "mode": "id",
          "value": "A7jtymr5C7eAI6Ot"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 2.2,
      "position": [
        -80,
        992
      ],
      "id": "73769ac6-c761-4621-b3a0-e5c01f0a9608",
      "name": "generate chartjs"
    },
    {
      "parameters": {
        "language": "python",
        "pythonCode": "import time\nimport hmac\nimport hashlib\nimport base64\nimport urllib.parse\n\n\nfor item in _input.all():\n  timestamp = str(round(time.time() * 1000))\n  secret = 'SECa1a0d1aa4bbbefba2a2b7ee8f054c83a2bf498ff6e62f51e33cc4d427c1bba72'\n  secret_enc = secret.encode('utf-8')\n  string_to_sign = '{}\\n{}'.format(timestamp, secret)\n  string_to_sign_enc = string_to_sign.encode('utf-8')\n  hmac_code = hmac.new(secret_enc, string_to_sign_enc, digestmod=hashlib.sha256).digest()\n  sign = urllib.parse.quote_plus(base64.b64encode(hmac_code))\n  item.json.timestamp = timestamp\n  item.json.sign = sign \nreturn _input.all()"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2160,
        736
      ],
      "id": "0cb94a1a-7661-4bb8-93af-5cefb503ef21",
      "name": "sign dingding data"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://qyapi.weixin.qq.com/cgi-bin/webhook/send",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "key",
              "value": "a5450767-ad81-4dd6-b0a2-fa3074ea4811"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"msgtype\": \"markdown\",\n    \"markdown\": {\n        \"content\": {{ $json.markdown.content.toJsonString() }}\n    }\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        2160,
        432
      ],
      "id": "da491918-f952-408b-aeaa-428f8fcfb595",
      "name": "Send msg to wechat"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://oapi.dingtalk.com/robot/send?access_token=5c2fd8b5a1fe9afbeee13c3564cfda40ac9698b5a24acafeeca1d85271e3e35f",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "timestamp",
              "value": "={{ $json.timestamp }}"
            },
            {
              "name": "=sign",
              "value": "={{ $json.sign }}"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n     \"msgtype\": \"markdown\",\n     \"markdown\": {\n         \"title\":\"æ™ºèƒ½AIæ¨é€\",\n         \"text\": {{ $json.markdown.content.toJsonString() }}\n    },\n      \"at\": {\n          \"atMobiles\": [],\n          \"atUserIds\": [],\n          \"isAtAll\": true\n      }\n }",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        2528,
        736
      ],
      "id": "61bbdc1f-d9c2-427d-9872-08e8c46a9f59",
      "name": "Send msg to dingding"
    }
  ],
  "pinData": {},
  "connections": {
    "Window Buffer Memory": {
      "ai_memory": [
        [
          {
            "node": "natural language to sql",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Add table name to output": {
      "main": [
        [
          {
            "node": "Convert data to Json",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract data from file": {
      "main": [
        [
          {
            "node": "Combine schema data and chat input",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When clicking \"Test workflow\"": {
      "main": [
        [
          {
            "node": "query tables name",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Combine schema data and chat input": {
      "main": [
        [
          {
            "node": "natural language to sql",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Load the schema from the local file": {
      "main": [
        [
          {
            "node": "Extract data from file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert data to Json": {
      "main": [
        [
          {
            "node": "Save file locally",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "query table column": {
      "main": [
        [
          {
            "node": "Add table name to output",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "query tables name": {
      "main": [
        [
          {
            "node": "query table column",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "DeepSeek Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "natural language to sql",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "natural language to sql": {
      "main": [
        [
          {
            "node": "sql query",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "sql query": {
      "main": [
        [
          {
            "node": "sql to natural language",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è‡ªç„¶è¯­è¨€chat": {
      "ai_languageModel": [
        [
          {
            "node": "sql to natural language",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Chat Trigger": {
      "main": [
        [
          {
            "node": "Load the schema from the local file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "sql to natural language": {
      "main": [
        [
          {
            "node": "covert msg to markdown",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "covert msg to markdown": {
      "main": [
        [
          {
            "node": "sign dingding data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When Executed by Another Workflow": {
      "main": [
        [
          {
            "node": "AI Agent Chart Generator",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser": {
      "ai_outputParser": [
        [
          {
            "node": "AI Agent Chart Generator",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "DeepSeek change chartjs": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent Chart Generator",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent Chart Generator": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "generate chartjs": {
      "ai_tool": [
        []
      ]
    },
    "Send msg to wechat": {
      "main": [
        []
      ]
    },
    "sign dingding data": {
      "main": [
        [
          {
            "node": "Send msg to dingding",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "513b6c42-8945-4fa3-bad7-96d2f67dd9cb",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "3db276c850feb25139d631a19ebeca34feadf3652e6dbc42547227dfca91782e"
  },
  "id": "A7jtymr5C7eAI6Ot",
  "tags": []
}